getPairs <- function(dsL, dsH){
dsmgL = filter(dsmg, deltaSmg <= dsL) %>% select(-deltaSmg);
dsmgH = filter(dsmg, deltaSmg >= dsH) %>% select(-deltaSmg)
dsusL = filter(dsus, deltaSus <= dsL) %>% select(-deltaSus);
dsusH = filter(dsus, deltaSus >= dsH) %>% select(-deltaSus)
mgL_usH = inner_join(dsmgL, dsusH, by = c('concept1', 'concept2', 'color1', 'color2')) %>% # common rows between the two dataframes
rename(mgL_usH1 = color1, mgL_usH2 = color2)
mgH_usH = inner_join(dsmgH, dsusH, by = c('concept1', 'concept2', 'color1', 'color2')) %>%
rename(mgH_usH1 = color1, mgH_usH2 = color2)
mgL_usL = inner_join(dsmgL, dsusL, by = c('concept1', 'concept2', 'color1', 'color2')) %>%
rename(mgL_usL1 = color1, mgL_usL2 = color2)
mgH_usL = inner_join(dsmgH, dsusL, by = c('concept1', 'concept2', 'color1', 'color2')) %>%
rename(mgH_usL1 = color1, mgH_usL2 = color2)
final <- mgL_usH %>%
full_join(mgH_usH, by = c('concept1', 'concept2')) %>%
full_join(mgL_usL, by = c('concept1', 'concept2')) %>%
full_join(mgH_usL, by = c('concept1', 'concept2')) %>% drop_na()
return(final)
}
final <- getPairs(0.1, 0.7)
## Adding color code to Final dataset
bcp37 <- read_csv("utils/color_values_bcp37.csv")# %>% select('name', 'color', 'hex')
write_csv(final, "output/final-01-07.csv")
final %>% distinct(concept1, concept2)
a <- final %>% group_by(concept1, concept2) %>% summarize(
freq = n()
); a
library(jsonlite)
# Sample data (replace with your actual data)
# df <- data.frame(
#   concept1 = c("banana", "banana", "test1"),
#   concept2 = c("love", "love", "test2"),
#   mgL_usH1 = c("WH", "SR", "LH1"),
#   mgL_usH2 = c("XR", "MR", "LH2"),
#   mgH_usH1 = c("MG", "WH", "HH1"),
#   mgH_usH2 = c("MR", "MG", "HH2"),
#   mgL_usL1 = c("SR", "MR", "MR"),
#   mgL_usL2 = c("MG", "WH", "MR"),
#   mgH_usL1 = c("WH", "SR", "SR"),
#   mgH_usL2 = c("MR", "MG", "XR"),
#   stringsAsFactors = FALSE
# )
df <- final %>% filter(mgL_usH1 == "WH", mgL_usH2 == "DP", mgH_usH1=="DG", mgH_usH2 == "BK")
json_list <- list()
for (i in 1:nrow(df)) {
# Extract values for the current row
row_data <- df[i, ]
# Define the JSON structure for the current row
json_data <- list(
concept1 = row_data$concept1,
concept2 = row_data$concept2,
mgL_usH = list(row_data$mgL_usH1, row_data$mgL_usH2),
mgH_usH = list(row_data$mgH_usH1, row_data$mgH_usH2),
mgL_usL = list(row_data$mgL_usL1, row_data$mgL_usL2),
mgH_usL = list(row_data$mgH_usL1, row_data$mgH_usL2))
# Append the JSON structure to the list
json_list[[i]] <- json_data
}
# Convert the entire list to JSON and write it to a single file
json_string <- toJSON(json_list, pretty = TRUE, auto_unbox = TRUE)
print(json_string)
write(json_string, file = "output/final-01-07.json")
# df2 <- data.frame(
#   color = c("WH", "SR", "MR", "MG", "XR", "LH1", "LH2", "HH1", "HH2"),
#   hex = c("white", "red", "orange", "green", "purple", "lightyellow", "light", "HH1", "HH2"),
#   L = c(100, 70, 40, 30, 0, 0,0,0,0),
#   a = c(0, 70, -70, 0, 0,0,0,0,0),
#   b = c(0, 0, 70, -70, 0,0,0,0,0),
#   stringsAsFactors = FALSE
# )
df2 <- bcp37
# Function to create JSON-like entry
create_json_entry <- function(code) {
entry <- df2 %>% filter(color == code)
if (nrow(entry) > 0) {
return(list(color = code, hex = entry$hex, L = entry$L, a = entry$a, b = entry$b))
# return(list(color = code, hex = entry$hex, L = entry$L))
} else {
return(NULL)  # Return NULL if the color code doesn't exist in df2
}
}
# Replace color codes with JSON entries
df_replaced <- df %>%
mutate(across(starts_with("mg"), ~map(.x, create_json_entry)))
# Convert the transformed dataframe back to JSON
output_json <- toJSON(df_replaced, pretty = TRUE, auto_unbox = TRUE)
cat(output_json)
df_combined <- df_replaced %>%
mutate(mgL_usH = map2(mgL_usH1, mgL_usH2, ~ list(.x, .y))) %>%
mutate(mgL_usL = map2(mgL_usL1, mgL_usL2, ~ list(.x, .y))) %>%
mutate(mgH_usH = map2(mgH_usH1, mgH_usH2, ~ list(.x, .y))) %>%
mutate(mgH_usL = map2(mgH_usL1, mgH_usL2, ~ list(.x, .y))) %>%
select(-mgL_usH1, -mgL_usH2, -mgL_usL1, -mgL_usL2, -mgH_usH1, -mgH_usH2, -mgH_usL1, -mgH_usL2 )  # Remove the original keys
# Convert the modified dataframe back to JSON
output_json <- toJSON(df_combined, pretty = TRUE, auto_unbox = TRUE)
# Print the resulting JSON
cat(output_json)
# Print the resulting JSON
cat(output_json)
write(output_json, file = "output/full.json")
unique(df$mgH_usL2)
# Lower and Higher thresholds for deltaS
dsL = 0.1; dsH = 0.9
getPairs <- function(dsL, dsH){
dsmgL = filter(dsmg, deltaSmg <= dsL) %>% select(-deltaSmg);
dsmgH = filter(dsmg, deltaSmg >= dsH) %>% select(-deltaSmg)
dsusL = filter(dsus, deltaSus <= dsL) %>% select(-deltaSus);
dsusH = filter(dsus, deltaSus >= dsH) %>% select(-deltaSus)
mgL_usH = inner_join(dsmgL, dsusH, by = c('concept1', 'concept2', 'color1', 'color2')) %>% # common rows between the two dataframes
rename(mgL_usH1 = color1, mgL_usH2 = color2)
mgH_usH = inner_join(dsmgH, dsusH, by = c('concept1', 'concept2', 'color1', 'color2')) %>%
rename(mgH_usH1 = color1, mgH_usH2 = color2)
mgL_usL = inner_join(dsmgL, dsusL, by = c('concept1', 'concept2', 'color1', 'color2')) %>%
rename(mgL_usL1 = color1, mgL_usL2 = color2)
mgH_usL = inner_join(dsmgH, dsusL, by = c('concept1', 'concept2', 'color1', 'color2')) %>%
rename(mgH_usL1 = color1, mgH_usL2 = color2)
final <- mgL_usH %>%
full_join(mgH_usH, by = c('concept1', 'concept2')) %>%
full_join(mgL_usL, by = c('concept1', 'concept2')) %>%
full_join(mgH_usL, by = c('concept1', 'concept2')) %>% drop_na()
return(final)
}
final <- getPairs(0.1, 0.7)
knitr::opts_chunk$set(echo = TRUE)
source(file = './utils/exp1-utils.R')  # loads all necessary packages
final <- getPairs(0.1, 0.7)
View(final)
# Lower and Higher thresholds for deltaS
dsL = 0.1; dsH = 0.9
getPairs <- function(dsL, dsH){
dsmgL = filter(dsmg, deltaSmg <= dsL) %>% select(-deltaSmg);
dsmgH = filter(dsmg, deltaSmg >= dsH) %>% select(-deltaSmg)
dsusL = filter(dsus, deltaSus <= dsL) %>% select(-deltaSus);
dsusH = filter(dsus, deltaSus >= dsH) %>% select(-deltaSus)
mgL_usH = inner_join(dsmgL, dsusH, by = c('concept1', 'concept2', 'color1', 'color2')) %>% # common rows between the two dataframes
rename(mgL_usH1 = color1, mgL_usH2 = color2)
mgH_usH = inner_join(dsmgH, dsusH, by = c('concept1', 'concept2', 'color1', 'color2')) %>%
rename(mgH_usH1 = color1, mgH_usH2 = color2)
mgL_usL = inner_join(dsmgL, dsusL, by = c('concept1', 'concept2', 'color1', 'color2')) %>%
rename(mgL_usL1 = color1, mgL_usL2 = color2)
mgH_usL = inner_join(dsmgH, dsusL, by = c('concept1', 'concept2', 'color1', 'color2')) %>%
rename(mgH_usL1 = color1, mgH_usL2 = color2)
final <- mgL_usH %>%
full_join(mgH_usH, by = c('concept1', 'concept2')) %>%
full_join(mgL_usL, by = c('concept1', 'concept2')) %>%
full_join(mgH_usL, by = c('concept1', 'concept2')) %>% drop_na()
return(final)
}
final <- getPairs(0.1, 0.7)
dsmgL = filter(dsmg, deltaSmg <= dsL) %>% select(-deltaSmg);
View(dsmgL)
View(dsmg)
dsmgH = filter(dsmg, deltaSmg >= dsH) %>% select(-deltaSmg)
dsusL = filter(dsus, deltaSus <= dsL) %>% select(-deltaSus);
dsusH = filter(dsus, deltaSus >= dsH) %>% select(-deltaSus)
mgL_usH = inner_join(dsmgL, dsusH, by = c('concept1', 'concept2', 'color1', 'color2')) %>% # common rows between the two dataframes
rename(mgL_usH1 = color1, mgL_usH2 = color2)
mgH_usH = inner_join(dsmgH, dsusH, by = c('concept1', 'concept2', 'color1', 'color2')) %>%
rename(mgH_usH1 = color1, mgH_usH2 = color2)
mgL_usL = inner_join(dsmgL, dsusL, by = c('concept1', 'concept2', 'color1', 'color2')) %>%
rename(mgL_usL1 = color1, mgL_usL2 = color2)
mgH_usL = inner_join(dsmgH, dsusL, by = c('concept1', 'concept2', 'color1', 'color2')) %>%
rename(mgH_usL1 = color1, mgH_usL2 = color2)
final <- mgL_usH %>%
full_join(mgH_usH, by = c('concept1', 'concept2')) %>%
full_join(mgL_usL, by = c('concept1', 'concept2')) %>%
full_join(mgH_usL, by = c('concept1', 'concept2')) %>% drop_na()
final <- mgL_usH %>%
full_join(mgH_usH, by = c('concept1', 'concept2')) %>%
full_join(mgL_usL, by = c('concept1', 'concept2')) %>%
full_join(mgH_usL, by = c('concept1', 'concept2')) # %>%
View(final)
View(final)
unique(final$mgL_usH1)
unique(final$mgL_usH2)
unique(final$mgH_usH1)
unique(final$mgH_usH2)
unique(final$mgL_usL1)
unique(final$mgL_usL2)
unique(final$mgH_usL1)
unique(final$mgH_usL2)
final%>%drop_na()
final <- mgL_usH %>%
full_join(mgH_usH, by = c('concept1', 'concept2'), relationship = "many-to-many") %>%
full_join(mgL_usL, by = c('concept1', 'concept2'), relationship = "many-to-many") %>%
full_join(mgH_usL, by = c('concept1', 'concept2'), relationship = "many-to-many") %>%
drop_na()
getPairs <- function(dsL, dsH){
dsmgL = filter(dsmg, deltaSmg <= dsL) %>% select(-deltaSmg);
dsmgH = filter(dsmg, deltaSmg >= dsH) %>% select(-deltaSmg)
dsusL = filter(dsus, deltaSus <= dsL) %>% select(-deltaSus);
dsusH = filter(dsus, deltaSus >= dsH) %>% select(-deltaSus)
mgL_usH = inner_join(dsmgL, dsusH, by = c('concept1', 'concept2', 'color1', 'color2')) %>% # common rows between the two dataframes
rename(mgL_usH1 = color1, mgL_usH2 = color2)
mgH_usH = inner_join(dsmgH, dsusH, by = c('concept1', 'concept2', 'color1', 'color2')) %>%
rename(mgH_usH1 = color1, mgH_usH2 = color2)
mgL_usL = inner_join(dsmgL, dsusL, by = c('concept1', 'concept2', 'color1', 'color2')) %>%
rename(mgL_usL1 = color1, mgL_usL2 = color2)
mgH_usL = inner_join(dsmgH, dsusL, by = c('concept1', 'concept2', 'color1', 'color2')) %>%
rename(mgH_usL1 = color1, mgH_usL2 = color2)
final <- mgL_usH %>%
full_join(mgH_usH, by = c('concept1', 'concept2'), relationship = "many-to-many") %>%
full_join(mgL_usL, by = c('concept1', 'concept2'), relationship = "many-to-many") %>%
full_join(mgH_usL, by = c('concept1', 'concept2'), relationship = "many-to-many") %>%
drop_na()
return(final)
}
final <- getPairs(0.1, 0.7)
final <- getPairs(0.1, 0.9)
final <- getPairs(0.1, 0.8)
final <- getPairs(0.2, 0.8)
final <- getPairs(0.1, 0.7)
final <- getPairs(0.1, 0.9)
getPairs <- function(dsL, dsH){
dsmgL = filter(dsmg, deltaSmg <= dsL) %>% select(-deltaSmg);
dsmgH = filter(dsmg, deltaSmg >= dsH) %>% select(-deltaSmg)
dsusL = filter(dsus, deltaSus <= dsL) %>% select(-deltaSus);
dsusH = filter(dsus, deltaSus >= dsH) %>% select(-deltaSus)
mgL_usH = inner_join(dsmgL, dsusH, by = c('concept1', 'concept2', 'color1', 'color2')) %>% # common rows between the two dataframes
rename(mgL_usH1 = color1, mgL_usH2 = color2)
mgH_usH = inner_join(dsmgH, dsusH, by = c('concept1', 'concept2', 'color1', 'color2')) %>%
rename(mgH_usH1 = color1, mgH_usH2 = color2)
mgL_usL = inner_join(dsmgL, dsusL, by = c('concept1', 'concept2', 'color1', 'color2')) %>%
rename(mgL_usL1 = color1, mgL_usL2 = color2)
mgH_usL = inner_join(dsmgH, dsusL, by = c('concept1', 'concept2', 'color1', 'color2')) %>%
rename(mgH_usL1 = color1, mgH_usL2 = color2)
final <- mgL_usH %>%
full_join(mgH_usH, by = c('concept1', 'concept2'), relationship = "many-to-many") %>%
full_join(mgL_usL, by = c('concept1', 'concept2'), relationship = "many-to-many") %>%
full_join(mgH_usL, by = c('concept1', 'concept2'), relationship = "many-to-many") # %>%
drop_na()
return(final)
}
final <- getPairs(0.1, 0.9)
getPairs <- function(dsL, dsH){
dsmgL = filter(dsmg, deltaSmg <= dsL) %>% select(-deltaSmg);
dsmgH = filter(dsmg, deltaSmg >= dsH) %>% select(-deltaSmg)
dsusL = filter(dsus, deltaSus <= dsL) %>% select(-deltaSus);
dsusH = filter(dsus, deltaSus >= dsH) %>% select(-deltaSus)
mgL_usH = inner_join(dsmgL, dsusH, by = c('concept1', 'concept2', 'color1', 'color2')) %>% # common rows between the two dataframes
rename(mgL_usH1 = color1, mgL_usH2 = color2)
mgH_usH = inner_join(dsmgH, dsusH, by = c('concept1', 'concept2', 'color1', 'color2')) %>%
rename(mgH_usH1 = color1, mgH_usH2 = color2)
mgL_usL = inner_join(dsmgL, dsusL, by = c('concept1', 'concept2', 'color1', 'color2')) %>%
rename(mgL_usL1 = color1, mgL_usL2 = color2)
mgH_usL = inner_join(dsmgH, dsusL, by = c('concept1', 'concept2', 'color1', 'color2')) %>%
rename(mgH_usL1 = color1, mgH_usL2 = color2)
final <- mgL_usH %>%
full_join(mgH_usH, by = c('concept1', 'concept2'), relationship = "many-to-many") %>%
full_join(mgL_usL, by = c('concept1', 'concept2'), relationship = "many-to-many") %>%
full_join(mgH_usL, by = c('concept1', 'concept2'), relationship = "many-to-many") # %>% drop_na()
return(final)
}
final <- getPairs(0.1, 0.9)
View(final)
unique(final$mgH_usH1)
unique(final$mgH_usH2)
unique(final[,c('concept1','concept2')])
length(unique(final[,c('concept1','concept2')]))
nrow(unique(final[,c('concept1','concept2')]))
nrow(filter(final, concept1 == 'angry', concept2 == 'happy'))
final <- getPairs(0.1, 0.8)
final <- getPairs(0.1, 0.8)
final <- getPairs(0.1, 0.9)
final <- getPairs(0.1, 0.9) %>% drop_na()
final <- getPairs(0.1, 0.9) # %>% filter(mgH_usH)
final <- getPairs(0.1, 0.9) # %>% filter(mgH_usH)
names(final)[sapply(final, function(x) sum(is.na(x)) == length(x))]
final <- getPairs(0.1, 0.9) %>% filter(!is.na(mgH_usL1), !is.na(mgH_usL2))
final <- getPairs(0.1, 0.8) %>%
filter(!is.na(mgH_usL1), !is.na(mgH_usL2))
final <- getPairs(0.1, 0.7) %>%
filter(!is.na(mgH_usL1), !is.na(mgH_usL2))
View(final)
# unique combinations of two columns concept1 and concept2
unique(final[,c('concept1', 'concept2')])
final %>% group_by(concept1, concept2) %>% summarise(n = n())
final <- getPairs(0.1, 0.75) %>%
filter(!is.na(mgH_usL1), !is.na(mgH_usL2))
# find which columns of the dataframe only have NAs
names(final)[sapply(final, function(x) sum(is.na(x)) == length(x))]
# unique combinations of two columns concept1 and concept2
unique(final[,c('concept1', 'concept2')])
final <- getPairs(0.1, 0.74) %>%
filter(!is.na(mgH_usL1), !is.na(mgH_usL2))
# find which columns of the dataframe only have NAs
names(final)[sapply(final, function(x) sum(is.na(x)) == length(x))]
final <- getPairs(0.1, 0.73) %>%
filter(!is.na(mgH_usL1), !is.na(mgH_usL2))
# find which columns of the dataframe only have NAs
names(final)[sapply(final, function(x) sum(is.na(x)) == length(x))]
# unique combinations of two columns concept1 and concept2
unique(final[,c('concept1', 'concept2')])
## Adding color code to Final dataset
bcp37 <- read_csv("utils/color_values_bcp37.csv")# %>% select('name', 'color', 'hex')
final %>% group_by(concept1, concept2) %>% summarise(n = n())
final <- getPairs(0.1, 0.9)%>% drop_na()
final <- getPairs(0.2, 0.9)%>% drop_na()
final <- getPairs(0.3, 0.9)%>% drop_na()
final <- getPairs(0.4, 0.9)%>% drop_na()
final <- getPairs(0.5, 0.9)%>% drop_na()
final <- getPairs(0.5, 0.9) %>% #drop_na()
filter(!is.na(mgH_usL1), !is.na(mgH_usL2))
final <- getPairs(0.5, 0.9) %>% #drop_na()
filter(!is.na(mgH_usL1), !is.na(mgH_usL2))
final <- getPairs(0.5, 0.9) #%>% #drop_na()
final <- getPairs(0.5, 0.9) # %>% drop_na()
# find which columns of the dataframe only have NAs
names(final)[sapply(final, function(x) sum(is.na(x)) == length(x))]
final <- final %>% filter(!is.na(mgH_usL1), !is.na(mgH_usL2))
final <- getPairs(0.6, 0.9) # %>% drop_na()
# find which columns of the dataframe only have NAs
names(final)[sapply(final, function(x) sum(is.na(x)) == length(x))]
final <- final %>% filter(!is.na(mgH_usL1), !is.na(mgH_usL2))
final <- getPairs(0.8, 0.9) # %>% drop_na()
# find which columns of the dataframe only have NAs
names(final)[sapply(final, function(x) sum(is.na(x)) == length(x))]
final <- final %>% filter(!is.na(mgH_usL1), !is.na(mgH_usL2))
final %>% distinct(concept1, concept2)
rm(i)
rm(a_mg, a_mg2, a_us, a_us2)
View(final)
final <- getPairs(0.3, 0.7) # %>% drop_na()
final <- final %>% filter(!is.na(mgH_usL1), !is.na(mgH_usL2))
final <- getPairs(0.1, 0.7) # %>% drop_na()
final <- getPairs(0.1, 0.7)  %>% drop_na()
View(final)
low = 0.3; hi = 0.7
a <- getPairs(low, hi)
n_color_pairs <- a %>% group_by(concept1, concept2) %>% summarize(
mgL_usL = nrow(c(mgL_usL1, mgL_usL2))
)
View(n_color_pairs)
n_color_pairs <- a %>% group_by(concept1, concept2) %>% summarize(
mgL_usL = 1
)
n_color_pairs <- a %>% group_by(concept1, concept2) %>% summarize(
mgL_usL = nrow(mgL_usL1)
)
n_color_pairs <- a %>% group_by(concept1, concept2) %>% summarize(
mgL_usL = length(mgL_usL1)
)
n_color_pairs <- a %>% group_by(concept1, concept2) %>% summarize(
mgL_usL1 = length(mgL_usL1)
mgL_usL2 = length(mgL_usL2)
n_color_pairs <- a %>% group_by(concept1, concept2) %>% summarize(
mgL_usL1 = length(mgL_usL1),
mgL_usL2 = length(mgL_usL2)
)
n_color_pairs <- a %>% group_by(concept1, concept2) %>% summarize(
mgL_usL = length(mgL_usL1), mgL_usH = length(mgL_usH1),
mgH_usL = length(mgH_usL1), mgH_usH = length(mgH_usH1)
)}
n_color_pairs <- a %>% group_by(concept1, concept2) %>% summarize(
mgL_usL = length(mgL_usL1), mgL_usH = length(mgL_usH1),
mgH_usL = length(mgH_usL1), mgH_usH = length(mgH_usH1)
)
View(n_color_pairs)
a <- getPairs(low, hi)
n_concepts <- rbind(n_concepts, a %>% group_by(concept1, concept2) %>% summarize(n_con_pair = n()))
n_concepts <- data.frame()
n_concepts <- rbind(n_concepts, a %>% group_by(concept1, concept2) %>% summarize(n_con_pair = n()))
View(n_concepts)
scatterDf <- data.frame()
scatterDf <- data.frame()
for (low in c(0.1, 0.2, 0.3, 0.4, 0.5)){
for (hi in c(0.9, 0.8, 0.7, 0.6)){
a <- getPairs(low, hi) %>%
group_by(concept1, concept2) %>% summarize(
n_con_pair = n(),
mgL_usL = length(mgL_usL1), mgL_usH = length(mgL_usH1),
mgH_usL = length(mgH_usL1), mgH_usH = length(mgH_usH1))
a$dsLow = low; a$dsHi = hi
scatterDf <- rbind(scatterDf, a)
}
}
scatterDf <- data.frame()
scatterDf <- data.frame()
for (low in c(0.1, 0.2, 0.3, 0.4)){
for (hi in c(0.9, 0.8, 0.7)){
a <- getPairs(low, hi) %>%
group_by(concept1, concept2) %>% summarize(
n_con_pair = n(),
mgL_usL = length(mgL_usL1), mgL_usH = length(mgL_usH1),
mgH_usL = length(mgH_usL1), mgH_usH = length(mgH_usH1)) %>% ungroup()
a$dsLow = low; a$dsHi = hi
scatterDf <- rbind(scatterDf, a)
}
}
scatterDf <- data.frame()
for (low in c(0.1, 0.2, 0.3, 0.4)){
for (hi in c(0.9, 0.8, 0.7)){
a <- getPairs(low, hi) %>%
group_by(concept1, concept2) %>% summarize(
n_con_pair = n(),
mgL_usL = length(mgL_usL1), mgL_usH = length(mgL_usH1),
mgH_usL = length(mgH_usL1), mgH_usH = length(mgH_usH1), .groups = 'drop')
a$dsLow = low; a$dsHi = hi
scatterDf <- rbind(scatterDf, a)
}
}
a <- getPairs(low, hi) %>%
group_by(concept1, concept2) %>% summarize(
n_con_pair = n(),
mgL_usL = length(mgL_usL1), mgL_usH = length(mgL_usH1),
mgH_usL = length(mgH_usL1), mgH_usH = length(mgH_usH1), .groups = 'drop') %>% group_vars()
scatterDf <- data.frame()
for (low in c(0.1, 0.2, 0.3, 0.4)){
for (hi in c(0.9, 0.8, 0.7)){
a <- getPairs(low, hi) %>%
group_by(concept1, concept2) %>% summarize(
n_con_pair = n(),
mgL_usL = length(mgL_usL1), mgL_usH = length(mgL_usH1),
mgH_usL = length(mgH_usL1), mgH_usH = length(mgH_usH1), .groups = 'drop')
a$dsLow = low; a$dsHi = hi
scatterDf <- rbind(scatterDf, a)
}
}
View(scatterDf)
scatterDf <- data.frame()
tmp <- getPairs(low, hi)
hi = 0.3
tmp <- getPairs(low, hi)
low = 0.2
hi = 0.7
tmp <- getPairs(low, hi)
a <- tmp %>% group_by(concept1, concept2) %>% summarize(
n_con_pair = n(),
mgL_usL = length(mgL_usL1), mgL_usH = length(mgL_usH1),
mgH_usL = length(mgH_usL1), mgH_usH = length(mgH_usH1), .groups = 'drop')
View(a)
a <- tmp %>% group_by(concept1, concept2) %>% summarize(
n_con_pair = n(),
mgL_usL = sum(!is.na(mgL_usL1)), mgL_usH = sum(!is.na(mgL_usH1)),
mgH_usL = sum(!is.na(mgH_usL1)), mgH_usH = sum(!is.na(mgH_usH1)), .groups = 'drop')
View(a)
a$dsLow = low; a$dsHi = hi
scatterDf <- data.frame()
for (low in c(0.1, 0.2, 0.3)){
for (hi in c(0.9, 0.8, 0.7)){
tmp <- getPairs(low, hi)
a <- tmp %>% group_by(concept1, concept2) %>% summarize(
n_con_pair = n(),
mgL_usL = sum(!is.na(mgL_usL1)), mgL_usH = sum(!is.na(mgL_usH1)),
mgH_usL = sum(!is.na(mgH_usL1)), mgH_usH = sum(!is.na(mgH_usH1)), .groups = 'drop')
a$dsLow = low; a$dsHi = hi
scatterDf <- rbind(scatterDf, a)
}
}
rm(tmp)
View(scatterDf)
View(mgL_usL)
View(a)
knitr::opts_chunk$set(echo = TRUE)
source(file = './utils/exp1-utils.R')  # loads all necessary packages
source(file = './utils/stimuli.R')
mgdem <- read_csv("data/exp1/csv/clean/mg-dem-p3.csv") %>% filter(progressBlock == 14, progressColor == 37)
mgdf <- read_csv("data/exp1/csv/clean/mg-p3.csv") %>% filter(ID %in% unique(mgdem$sessionID))
conceptListEn3 = c('banana', 'mango', 'peach', 'death', 'justice', 'peace', 'safety',
'angry', 'happy', 'sad', 'sick', 'lightning', 'sandstorm', 'tree')
conceptListFr3 = c('banane', 'mangue', 'pêche', 'mort', 'justice', 'peace', 'sécurité',
'en colère', 'heureux', 'triste', 'malade', 'foudre', 'tempête de sable', 'arbre')
mgdf <- translateConcepts(mgdf, conceptListFr3, conceptListEn3)
mgdf$expCountry <- "mdg"
# adding weights
mgdf$rating <- round(mgdf$ans/100, digits = 3)
mgdf_w <- mgdf %>% group_by(expCountry, concept, color) %>% summarize(
weight = round(mean(rating), digits = 3),
se = round(sd(rating)/sqrt(length(rating)), digits = 3), .groups = 'drop') # standard error
mgdf_w <- full_join(mgdf_w, bcp37hex, by = "color") %>% mutate(barStroke = ifelse(color == "WH", "#000000", hex))
# -alt.csv data are named so because they are stored in a separate 'alternative' firebase database due to R/W limitation per project on firebase.
usdem <- read_csv("data/exp1/csv/clean/us-dem-p3.csv") %>% filter(progressBlock == 14, progressColor == 37)
usdem_alt <- read_csv("data/exp1/csv/clean/us-dem-p3-alt.csv") %>% filter(progressBlock == 14, progressColor == 37)
usdem <- rbind(usdem, usdem_alt)
usdf <- read_csv("data/exp1/csv/clean/us-p3.csv")
usdf_alt <- read_csv("data/exp1/csv/clean/us-p3-alt.csv")
usdf <- rbind(usdf, usdf_alt) %>% filter(ID %in% unique(usdem$sessionID)) ; rm(usdem_alt, usdf_alt)
usdf$expCountry <- "usa"
# adding weights
usdf$rating <- round(usdf$ans/100, digits = 3)
usdf_w <- usdf %>% group_by(expCountry, concept, color) %>%  summarise(
weight = round(mean(rating), digits = 3),
se = round(sd(rating)/sqrt(length(rating)), digits = 3), .groups = 'drop')
usdf_w <- full_join(usdf_w, bcp37hex, by = 'color') %>% mutate(barStroke = ifelse(color == 'WH', "#000000", hex))
## Association weight MDG
mgdf_w$con = factor(mgdf_w$concept, levels=conceptListEn3) # to order the facet strips
p1 <- plotWeight_Err(mgdf_w, "Mean weight of assoc, lib: BCP37, MDG"); p1
## Association weight USA
usdf_w$con = factor(usdf_w$concept, levels=conceptListEn3) # to order the facet strips
p2 <- plotWeight_Err(usdf_w, "Mean weight of assoc., lib: BCP37, USA") +
theme(axis.title.y = element_blank(), axis.text.y = element_blank()); p2
p12 <- grid.arrange(p1, p2, nrow = 1)
p12
View(p12)
grid.arrange(p1, p2, nrow = 1)
knitr::opts_chunk$set(echo = TRUE)
source(file = './utils/exp1-utils.R')  # loads all necessary packages //NOTE: some packages
source(file = './utils/exp2-utils.R')
source(file = './utils/stimuli.R')
mgdf_w <- read_csv("data/exp1/csv/clean/p3-mg-weight.csv")
usdf_w <- read_csv("data/exp1/csv/clean/p3-us-weight.csv")
conceptListEn3 = c('banana', 'mango', 'peach', 'death', 'justice', 'peace', 'safety',
'angry', 'happy', 'sad', 'sick', 'lightning', 'sandstorm', 'tree')
conceptListFr3 = c('banane', 'mangue', 'pêche', 'mort', 'justice', 'peace', 'sécurité',
'en colère', 'heureux', 'triste', 'malade', 'foudre', 'tempête de sable', 'arbre')
concepts <- conceptListEn3
# mg <- mgdf_w
nTopColor = 4
## Dataframe with candidate pairs
cand_mg <- genCandidatesWithin(mgdf_w, concepts, nTopColor)
cand_us <- genCandidatesWithin(usdf_w, concepts, nTopColor)
View(cand_mg)
