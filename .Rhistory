###### Fitting function for the sd. Model s = a.xbar.(1-xbar)
# function to get the value of the coeff a
getFitCoeffSd <- function(data){
d1 <- data[1,]; a_us_start = d1$sd_sample / (d1$xbar * (1 - d1$xbar))
fit_us <- nls( sd_sample ~ a * xbar * (1-xbar), data = data, start = list(a = a_us_start))
return(coef(fit))
}
a_us <- getFitCoeffSd(dfus_agg)
a_us
knitr::opts_chunk$set(echo = TRUE)
source(file = './utils/exp1-utils.R')  # loads all necessary packages
# raw data
dfus = read_csv("data/exp1/csv/clean/p3-us.csv")
dfmg = read_csv("data/exp1/csv/clean/p3-mg.csv") # extra column 'conceptFr' for the concept name in French
# Unique pairs of concepts and colors without repetition
concept_pairs <- t(combn(unique(dfus$concept), 2))
color_pairs <- t(combn(unique(dfmg$color), 2))
View(color_pairs)
###### Fitting function for the sd. Model s = a.xbar.(1-xbar)
# function to get the value of the coeff a
getFitCoeffSd <- function(data){
d1 <- data[1,]; a_us_start = d1$sd_sample / (d1$xbar * (1 - d1$xbar))
fit_us <- nls( sd_sample ~ a * xbar * (1-xbar), data = data, start = list(a = a_us_start))
return(coef(fit))
}
a_us <- getFitCoeffSd(dfus_agg) # a = 1.384426
# Aggregated data (x = average rating for each color of each concept)
dfus_agg <- dfus %>% group_by(concept, color) %>% summarise(xbar = mean(rating), sd_sample = sd(rating), .groups = 'drop')
dfmg_agg <- dfmg %>% group_by(concept, color) %>% summarise(xbar = mean(rating), sd_sample = sd(rating), .groups = 'drop')
###### Fitting function for the sd. Model s = a.xbar.(1-xbar)
# function to get the value of the coeff a
getFitCoeffSd <- function(data){
d1 <- data[1,]; a_us_start = d1$sd_sample / (d1$xbar * (1 - d1$xbar))
fit_us <- nls( sd_sample ~ a * xbar * (1-xbar), data = data, start = list(a = a_us_start))
return(coef(fit))
}
a_us <- getFitCoeffSd(dfus_agg) # a = 1.384426
###### Fitting function for the sd. Model s = a.xbar.(1-xbar)
# function to get the value of the coeff a
getFitCoeffSd <- function(data){
d1 <- data[1,]; a_us_start = d1$sd_sample / (d1$xbar * (1 - d1$xbar))
fit <- nls( sd_sample ~ a * xbar * (1-xbar), data = data, start = list(a = a_us_start))
return(coef(fit))
}
a_us <- getFitCoeffSd(dfus_agg) # a = 1.384426
# Plotting the data points, and fitted curve
plot(dfus_agg$xbar, dfus_agg$sample_sd, main = "Fitting the Function s = a * xbar * (1 - xbar)",
xlab = "Mean (xbar)", ylab = "Standard Deviation (s)", pch = 16)
# Adding the fitted curve
curve(coef(fit) * x * (1 - x), add = TRUE, col = "blue", lwd = 2)
# Plotting the data points, and fitted curve
plot(dfus_agg$xbar, dfus_agg$sd_sample, main = "Fitting the Function s = a * xbar * (1 - xbar)",
xlab = "Mean (xbar)", ylab = "Standard Deviation (s)", pch = 16)
# Adding the fitted curve
curve(coef(fit) * x * (1 - x), add = TRUE, col = "blue", lwd = 2)
###### Fitting function for the sd. Model s = a.xbar.(1-xbar)
# function to get the value of the coeff a
getFitSd <- function(data){
d1 <- data[1,]; a_us_start = d1$sd_sample / (d1$xbar * (1 - d1$xbar))
fit <- nls( sd_sample ~ a * xbar * (1-xbar), data = data, start = list(a = a_us_start))
return(fit)
}
a_us <- coef(getFitSd(dfus_agg)) # a = 1.384426
a_us <- coef(getFitSd(dfus_agg)) # a = 1.384426
# Plotting the data points, and fitted curve
plot(dfus_agg$xbar, dfus_agg$sd_sample, main = "Fitting the Function s = a * xbar * (1 - xbar)",
xlab = "Mean (xbar)", ylab = "Standard Deviation (s)", pch = 16)
# Adding the fitted curve
curve(coef(getFitSd(dfus_agg)) * x * (1 - x), add = TRUE, col = "blue", lwd = 2)
# Adding the fitted curve
curve(coef(getFitSd(dfus_agg)) * x * (1 - x), add = TRUE, col = "red", lwd = 2)
# Adding the fitted curve
curve(coef(getFitSd(dfus_agg)) * x * (1 - x), add = TRUE, col = "orange", lwd = 2)
# Plotting the data points, and fitted curve
plot(dfus_agg$xbar, dfus_agg$sd_sample, main = "Fitting the Function s = a * xbar * (1 - xbar)",
xlab = "Mean (xbar)", ylab = "Standard Deviation (s)", pch = 6)
# Adding the fitted curve
curve(coef(getFitSd(dfus_agg)) * x * (1 - x), add = TRUE, col = "orange", lwd = 2)
1
1
# Plotting the data points, and fitted curve
plot(dfus_agg$xbar, dfus_agg$sd_sample, main = "Fitting the Function s = a * xbar * (1 - xbar)",
xlab = "Mean (xbar)", ylab = "Standard Deviation (s)", pch = 16)
# Adding the fitted curve
curve(coef(getFitSd(dfus_agg)) * x * (1 - x), add = TRUE, col = "orange", lwd = 2)
# Adding the fitted curve
curve(coef(getFitSd(dfus_agg)) * x * (1 - x), add = TRUE, col = "purple", lwd = 2)
getXvalues <- function(data, concept_pairs, color_pairs){
res <- data.frame()
# Loop through all concept pairs and color pairs to populate the result dataframe
for (i in 1:nrow(concept_pairs)) {
for (j in 1:nrow(color_pairs)) {
concept1 <- concept_pairs[i, 1];
concept2 <- concept_pairs[i, 2]
color1 <- color_pairs[j, 1]; color2 <- color_pairs[j, 2]
# Combine into a new row
new_row <- data.frame(
concept1 = concept1,
concept2 = concept2,
color1 = color1,
color2 = color2,
xbar1 = data$xbar[data$concept == concept1 & data$color == color1],
xbar2 = data$xbar[data$concept == concept1 & data$color == color2],
xbar3 = data$xbar[data$concept == concept2 & data$color == color1],
xbar4 = data$xbar[data$concept == concept2 & data$color == color2],
sd_sample1 = data$sd_sample[data$concept == concept1 & data$color == color1],
sd_sample2 = data$sd_sample[data$concept == concept1 & data$color == color2],
sd_sample3 = data$sd_sample[data$concept == concept2 & data$color == color1],
sd_sample4 = data$sd_sample[data$concept == concept2 & data$color == color2],
)
# Add the new row to the result dataframe
res <- rbind(res, new_row)
}
}
return(res)
}
getXvalues <- function(data, concept_pairs, color_pairs, sd_fit_coef){
res <- data.frame()
# Loop through all concept pairs and color pairs to populate the result dataframe
for (i in 1:nrow(concept_pairs)) {
for (j in 1:nrow(color_pairs)) {
concept1 <- concept_pairs[i, 1];
concept2 <- concept_pairs[i, 2]
color1 <- color_pairs[j, 1]; color2 <- color_pairs[j, 2]
# Combine into a new row
new_row <- data.frame(
concept1 = concept1,
concept2 = concept2,
color1 = color1,
color2 = color2,
xbar1 = data$xbar[data$concept == concept1 & data$color == color1],
xbar2 = data$xbar[data$concept == concept1 & data$color == color2],
xbar3 = data$xbar[data$concept == concept2 & data$color == color1],
xbar4 = data$xbar[data$concept == concept2 & data$color == color2],
sd_sample1 = data$sd_sample[data$concept == concept1 & data$color == color1],
sd_sample2 = data$sd_sample[data$concept == concept1 & data$color == color2],
sd_sample3 = data$sd_sample[data$concept == concept2 & data$color == color1],
sd_sample4 = data$sd_sample[data$concept == concept2 & data$color == color2],
)
new_row <- mutate(new_row,
sd_fit1 = sd_fit_coef * xbar1 * (1 - xbar1),
sd_fit2 = sd_fit_coef * xbar2 * (1 - xbar),
sd_fit3 = sd_fit_coef * xbar3 * (1 - xbar),
sd_fit4 = sd_fit_coef * xbar4 * (1 - xbar))
# Add the new row to the result dataframe
res <- rbind(res, new_row)
}
}
return(res)
}
xUs <- getXvalues(dfus_agg, concept_pairs, color_pairs) %>% mutate( deltaX = (xbar1 + xbar4) - (xbar2 + xbar3))
getXvalues <- function(data, concept_pairs, color_pairs, sd_fit_coef){
res <- data.frame()
# Loop through all concept pairs and color pairs to populate the result dataframe
for (i in 1:nrow(concept_pairs)) {
for (j in 1:nrow(color_pairs)) {
concept1 <- concept_pairs[i, 1];
concept2 <- concept_pairs[i, 2]
color1 <- color_pairs[j, 1]; color2 <- color_pairs[j, 2]
# Combine into a new row
new_row <- data.frame(
concept1 = concept1,
concept2 = concept2,
color1 = color1,
color2 = color2,
xbar1 = data$xbar[data$concept == concept1 & data$color == color1],
xbar2 = data$xbar[data$concept == concept1 & data$color == color2],
xbar3 = data$xbar[data$concept == concept2 & data$color == color1],
xbar4 = data$xbar[data$concept == concept2 & data$color == color2],
sd_sample1 = data$sd_sample[data$concept == concept1 & data$color == color1],
sd_sample2 = data$sd_sample[data$concept == concept1 & data$color == color2],
sd_sample3 = data$sd_sample[data$concept == concept2 & data$color == color1],
sd_sample4 = data$sd_sample[data$concept == concept2 & data$color == color2]
)
new_row <- mutate(new_row,
sd_fit1 = sd_fit_coef * xbar1 * (1 - xbar1),
sd_fit2 = sd_fit_coef * xbar2 * (1 - xbar),
sd_fit3 = sd_fit_coef * xbar3 * (1 - xbar),
sd_fit4 = sd_fit_coef * xbar4 * (1 - xbar))
# Add the new row to the result dataframe
res <- rbind(res, new_row)
}
}
return(res)
}
xUs <- getXvalues(dfus_agg, concept_pairs, color_pairs) %>% mutate( deltaX = (xbar1 + xbar4) - (xbar2 + xbar3))
xUs <- getXvalues(dfus_agg, concept_pairs, color_pairs, a_us) %>% mutate( deltaX = (xbar1 + xbar4) - (xbar2 + xbar3))
getXvalues <- function(data, concept_pairs, color_pairs, sd_fit_coef){
res <- data.frame()
# Loop through all concept pairs and color pairs to populate the result dataframe
for (i in 1:nrow(concept_pairs)) {
for (j in 1:nrow(color_pairs)) {
concept1 <- concept_pairs[i, 1];
concept2 <- concept_pairs[i, 2]
color1 <- color_pairs[j, 1]; color2 <- color_pairs[j, 2]
# Combine into a new row
new_row <- data.frame(
concept1 = concept1,
concept2 = concept2,
color1 = color1,
color2 = color2,
xbar1 = data$xbar[data$concept == concept1 & data$color == color1],
xbar2 = data$xbar[data$concept == concept1 & data$color == color2],
xbar3 = data$xbar[data$concept == concept2 & data$color == color1],
xbar4 = data$xbar[data$concept == concept2 & data$color == color2],
sd_sample1 = data$sd_sample[data$concept == concept1 & data$color == color1],
sd_sample2 = data$sd_sample[data$concept == concept1 & data$color == color2],
sd_sample3 = data$sd_sample[data$concept == concept2 & data$color == color1],
sd_sample4 = data$sd_sample[data$concept == concept2 & data$color == color2]
)
new_row <- mutate(new_row,
sd_fit1 = sd_fit_coef * xbar1 * (1 - xbar1),
sd_fit2 = sd_fit_coef * xbar2 * (1 - xbar2),
sd_fit3 = sd_fit_coef * xbar3 * (1 - xbar3),
sd_fit4 = sd_fit_coef * xbar4 * (1 - xbar4))
# Add the new row to the result dataframe
res <- rbind(res, new_row)
}
}
return(res)
}
xUs <- getXvalues(dfus_agg, concept_pairs, color_pairs, a_us) %>% mutate( deltaX = (xbar1 + xbar4) - (xbar2 + xbar3))
getDeltaS <- function(data, sd_type){
if (sd_type == "sd_sample") {
data <- mutate(data, ProbDelta_greaterThan0 = pnorm( deltaX / sqrt(sd_sample1^2 + sd_sample2^2 + sd_sample3^2 + sd_sample4^2)))
} else if (sd_type == "sd_fit"){
data <- mutate(data, ProbDelta_greaterThan0 = pnorm( deltaX / sqrt(sd_fit1^2 + sd_fit2^2 + sd_fit3^2 + sd_fit4^2)))
}
data <- mutate(xUs, deltaS = abs(2 * ProbDelta_greaterThan0 - 1))
return(data)
}
View(xUs)
xUs <- mutate(xUs, ProbDelta_greaterThan0 = pnorm( deltaX / sqrt(var1 + var2 + var3 + var4)))
getDeltaS <- function(data, sd_type){
if (sd_type == "sd_sample") {
data <- mutate(data, ProbDelta_greaterThan0 = pnorm( deltaX / sqrt(sd_sample1^2 + sd_sample2^2 + sd_sample3^2 + sd_sample4^2)))
} else if (sd_type == "sd_fit"){
data <- mutate(data, ProbDelta_greaterThan0 = pnorm( deltaX / sqrt(sd_fit1^2 + sd_fit2^2 + sd_fit3^2 + sd_fit4^2)))
}
data <- mutate(xUs, deltaS = abs(2 * ProbDelta_greaterThan0 - 1))
return(data)
}
xUs_sample <- getDeltaS(xUs, "sd_sample")
getDeltaS <- function(data, sd_type){
if (sd_type == "sd_sample") {
data <- mutate(data, ProbDelta_greaterThan0 = pnorm( deltaX / sqrt(sd_sample1^2 + sd_sample2^2 + sd_sample3^2 + sd_sample4^2)))
} else if (sd_type == "sd_fit"){
data <- mutate(data, ProbDelta_greaterThan0 = pnorm( deltaX / sqrt(sd_fit1^2 + sd_fit2^2 + sd_fit3^2 + sd_fit4^2)))
}
# data <- mutate(xUs, deltaS = abs(2 * ProbDelta_greaterThan0 - 1))
return(data)
}
xUs_sample <- getDeltaS(xUs, "sd_sample")
getDeltaS <- function(data, sd_type){
if (sd_type == "sd_sample") {
data <- mutate(data, ProbDelta_greaterThan0 = pnorm( deltaX / sqrt(sd_sample1^2 + sd_sample2^2 + sd_sample3^2 + sd_sample4^2)))
} else if (sd_type == "sd_fit"){
data <- mutate(data, ProbDelta_greaterThan0 = pnorm( deltaX / sqrt(sd_fit1^2 + sd_fit2^2 + sd_fit3^2 + sd_fit4^2)))
}
data <- mutate(data, deltaS = abs(2 * ProbDelta_greaterThan0 - 1))
return(data)
}
xUs_sample <- getDeltaS(xUs, "sd_sample")
View(xUs_sample)
xUs_fit <- getDeltaS(xUs, "sd_fit")
View(xUs_fit)
View(xUs)
# raw data
dfus = read_csv("data/exp1/csv/clean/p3-us.csv")
dfmg = read_csv("data/exp1/csv/clean/p3-mg.csv") # extra column 'conceptFr' for the concept name in French
# Unique pairs of concepts and colors without repetition
concept_pairs <- t(combn(unique(dfus$concept), 2))
color_pairs <- t(combn(unique(dfmg$color), 2))
# Aggregated data (x = average rating for each color of each concept)
dfus_agg <- dfus %>% group_by(concept, color) %>% summarise(xbar = mean(rating), sd_sample = sd(rating), .groups = 'drop')
dfmg_agg <- dfmg %>% group_by(concept, color) %>% summarise(xbar = mean(rating), sd_sample = sd(rating), .groups = 'drop')
###### Fitting function for the sd. Model s = a.xbar.(1-xbar)
# function to get the value of the coeff a
getFitSd <- function(data){
d1 <- data[1,]; a_us_start = d1$sd_sample / (d1$xbar * (1 - d1$xbar))
fit <- nls( sd_sample ~ a * xbar * (1-xbar), data = data, start = list(a = a_us_start))
return(fit)
}
a_us <- coef(getFitSd(dfus_agg)) # a = 1.384426
# Plotting the data points, and fitted curve
plot(dfus_agg$xbar, dfus_agg$sd_sample, main = "Fitting the Function s = a * xbar * (1 - xbar)",
xlab = "Mean (xbar)", ylab = "Standard Deviation (s)", pch = 16)
# Adding the fitted curve
curve(coef(getFitSd(dfus_agg)) * x * (1 - x), add = TRUE, col = "orange", lwd = 2)
o
o
getXvalues <- function(data, concept_pairs, color_pairs, sd_fit_coef){
res <- data.frame()
# Loop through all concept pairs and color pairs to populate the result dataframe
for (i in 1:nrow(concept_pairs)) {
for (j in 1:nrow(color_pairs)) {
concept1 <- concept_pairs[i, 1];
concept2 <- concept_pairs[i, 2]
color1 <- color_pairs[j, 1]; color2 <- color_pairs[j, 2]
# Combine into a new row
new_row <- data.frame(
concept1 = concept1,
concept2 = concept2,
color1 = color1,
color2 = color2,
xbar1 = data$xbar[data$concept == concept1 & data$color == color1],
xbar2 = data$xbar[data$concept == concept1 & data$color == color2],
xbar3 = data$xbar[data$concept == concept2 & data$color == color1],
xbar4 = data$xbar[data$concept == concept2 & data$color == color2],
sd_sample1 = data$sd_sample[data$concept == concept1 & data$color == color1],
sd_sample2 = data$sd_sample[data$concept == concept1 & data$color == color2],
sd_sample3 = data$sd_sample[data$concept == concept2 & data$color == color1],
sd_sample4 = data$sd_sample[data$concept == concept2 & data$color == color2]
)
new_row <- mutate(new_row,
sd_fit1 = sd_fit_coef * xbar1 * (1 - xbar1),
sd_fit2 = sd_fit_coef * xbar2 * (1 - xbar2),
sd_fit3 = sd_fit_coef * xbar3 * (1 - xbar3),
sd_fit4 = sd_fit_coef * xbar4 * (1 - xbar4))
# Add the new row to the result dataframe
res <- rbind(res, new_row)
}
}
return(res)
}
# raw data
dfus = read_csv("data/exp1/csv/clean/p3-us.csv")
dfmg = read_csv("data/exp1/csv/clean/p3-mg.csv") # extra column 'conceptFr' for the concept name in French
# Unique pairs of concepts and colors without repetition
concept_pairs <- t(combn(unique(dfus$concept), 2))
color_pairs <- t(combn(unique(dfmg$color), 2))
# Aggregated data (x = average rating for each color of each concept)
dfus_agg <- dfus %>% group_by(concept, color) %>% summarise(xbar = mean(rating), sd_sample = sd(rating), .groups = 'drop')
dfmg_agg <- dfmg %>% group_by(concept, color) %>% summarise(xbar = mean(rating), sd_sample = sd(rating), .groups = 'drop')
###### Fitting function for the sd. Model s = a.xbar.(1-xbar)
# function to get the value of the coeff a
getFitSd <- function(data){
d1 <- data[1,]; a_us_start = d1$sd_sample / (d1$xbar * (1 - d1$xbar))
fit <- nls( sd_sample ~ a * xbar * (1-xbar), data = data, start = list(a = a_us_start))
return(fit)
}
a_us <- coef(getFitSd(dfus_agg)) # a = 1.384426
# Plotting the data points, and fitted curve
plot(dfus_agg$xbar, dfus_agg$sd_sample, main = "Fitting the Function s = a * xbar * (1 - xbar)",
xlab = "Mean (xbar)", ylab = "Standard Deviation (s)", pch = 16)
# Adding the fitted curve
curve(coef(getFitSd(dfus_agg)) * x * (1 - x), add = TRUE, col = "orange", lwd = 2)
getXvalues <- function(data, concept_pairs, color_pairs, sd_fit_coef){
res <- data.frame()
# Loop through all concept pairs and color pairs to populate the result dataframe
for (i in 1:nrow(concept_pairs)) {
for (j in 1:nrow(color_pairs)) {
concept1 <- concept_pairs[i, 1];
concept2 <- concept_pairs[i, 2]
color1 <- color_pairs[j, 1]; color2 <- color_pairs[j, 2]
# Combine into a new row
new_row <- data.frame(
concept1 = concept1,
concept2 = concept2,
color1 = color1,
color2 = color2,
xbar1 = data$xbar[data$concept == concept1 & data$color == color1],
xbar2 = data$xbar[data$concept == concept1 & data$color == color2],
xbar3 = data$xbar[data$concept == concept2 & data$color == color1],
xbar4 = data$xbar[data$concept == concept2 & data$color == color2],
sd_sample1 = data$sd_sample[data$concept == concept1 & data$color == color1],
sd_sample2 = data$sd_sample[data$concept == concept1 & data$color == color2],
sd_sample3 = data$sd_sample[data$concept == concept2 & data$color == color1],
sd_sample4 = data$sd_sample[data$concept == concept2 & data$color == color2]
)
new_row <- mutate(new_row,
sd_fit1 = sd_fit_coef * xbar1 * (1 - xbar1),
sd_fit2 = sd_fit_coef * xbar2 * (1 - xbar2),
sd_fit3 = sd_fit_coef * xbar3 * (1 - xbar3),
sd_fit4 = sd_fit_coef * xbar4 * (1 - xbar4))
# Add the new row to the result dataframe
res <- rbind(res, new_row)
}
}
return(res)
}
xUs <- getXvalues(dfus_agg, concept_pairs, color_pairs, a_us) %>% mutate( deltaX = (xbar1 + xbar4) - (xbar2 + xbar3))
xUs_sample <- getDeltaS(xUs, "sd_sample")
getDeltaS <- function(data, sd_type){
if (sd_type == "sd_sample") {
data <- mutate(data, ProbDelta_greaterThan0 = pnorm( deltaX / sqrt(sd_sample1^2 + sd_sample2^2 + sd_sample3^2 + sd_sample4^2)))
} else if (sd_type == "sd_fit"){
data <- mutate(data, ProbDelta_greaterThan0 = pnorm( deltaX / sqrt(sd_fit1^2 + sd_fit2^2 + sd_fit3^2 + sd_fit4^2)))
}
data <- mutate(data, deltaS = abs(2 * ProbDelta_greaterThan0 - 1))
return(data)
}
xUs_sample <- getDeltaS(xUs, "sd_sample")
xUs_fit <- getDeltaS(xUs, "sd_fit")
View(xUs_sample)
knitr::opts_chunk$set(echo = TRUE)
source(file = './utils/exp1-utils.R')  # loads all necessary packages
# raw data
dfus = read_csv("data/exp1/csv/clean/p3-us.csv")
dfmg = read_csv("data/exp1/csv/clean/p3-mg.csv") # extra column 'conceptFr' for the concept name in French
# Unique pairs of concepts and colors without repetition
concept_pairs <- t(combn(unique(dfus$concept), 2))
color_pairs <- t(combn(unique(dfmg$color), 2))
# Aggregated data (x = average rating for each color of each concept)
dfus_agg <- dfus %>% group_by(concept, color) %>% summarise(xbar = mean(rating), sd_sample = sd(rating), .groups = 'drop')
dfmg_agg <- dfmg %>% group_by(concept, color) %>% summarise(xbar = mean(rating), sd_sample = sd(rating), .groups = 'drop')
###### Fitting function for the sd. Model s = a.xbar.(1-xbar)
# function to get the value of the coeff a
getFitSd <- function(data){
d1 <- data[1,]; a_us_start = d1$sd_sample / (d1$xbar * (1 - d1$xbar))
fit <- nls( sd_sample ~ a * xbar * (1-xbar), data = data, start = list(a = a_us_start))
return(fit)
}
a_us <- coef(getFitSd(dfus_agg)) # a = 1.384426
# Plotting the data points, and fitted curve
plot(dfus_agg$xbar, dfus_agg$sd_sample, main = "Fitting the Function s = a * xbar * (1 - xbar)",
xlab = "Mean (xbar)", ylab = "Standard Deviation (s)", pch = 16)
# Adding the fitted curve
curve(coef(getFitSd(dfus_agg)) * x * (1 - x), add = TRUE, col = "orange", lwd = 2)
getXvalues <- function(data, concept_pairs, color_pairs, sd_fit_coef){
res <- data.frame()
# Loop through all concept pairs and color pairs to populate the result dataframe
for (i in 1:nrow(concept_pairs)) {
for (j in 1:nrow(color_pairs)) {
concept1 <- concept_pairs[i, 1];
concept2 <- concept_pairs[i, 2]
color1 <- color_pairs[j, 1]; color2 <- color_pairs[j, 2]
# Combine into a new row
new_row <- data.frame(
concept1 = concept1,
concept2 = concept2,
color1 = color1,
color2 = color2,
xbar1 = data$xbar[data$concept == concept1 & data$color == color1],
xbar2 = data$xbar[data$concept == concept1 & data$color == color2],
xbar3 = data$xbar[data$concept == concept2 & data$color == color1],
xbar4 = data$xbar[data$concept == concept2 & data$color == color2],
sd_sample1 = data$sd_sample[data$concept == concept1 & data$color == color1],
sd_sample2 = data$sd_sample[data$concept == concept1 & data$color == color2],
sd_sample3 = data$sd_sample[data$concept == concept2 & data$color == color1],
sd_sample4 = data$sd_sample[data$concept == concept2 & data$color == color2]
)
new_row <- mutate(new_row,
sd_fit1 = sd_fit_coef * xbar1 * (1 - xbar1),
sd_fit2 = sd_fit_coef * xbar2 * (1 - xbar2),
sd_fit3 = sd_fit_coef * xbar3 * (1 - xbar3),
sd_fit4 = sd_fit_coef * xbar4 * (1 - xbar4))
# Add the new row to the result dataframe
res <- rbind(res, new_row)
}
}
return(res)
}
xUs <- getXvalues(dfus_agg, concept_pairs, color_pairs, a_us) %>% mutate(deltaX = (xbar1 + xbar4) - (xbar2 + xbar3))
deltaS_us <- getDeltaS(xUs)
getDeltaS <- function(data){
data <- mutate(data,
ProbDelta_sample = pnorm( deltaX / sqrt(sd_sample1^2 + sd_sample2^2 + sd_sample3^2 + sd_sample4^2)),
ProbDelta_fit = pnorm( deltaX / sqrt(sd_fit1^2 + sd_fit2^2 + sd_fit3^2 + sd_fit4^2)))
data <- mutate(data,
deltaS_sample = abs(2 * ProbDelta_sample - 1),
deltaS_fit = abs(2 * ProbDelta_fit - 1))
return(data)
}
deltaS_us <- getDeltaS(xUs)
View(deltaS_us)
deltaS_us <- getDeltaS(xUs) %>% select(concept1, concept2, color1, color2, deltaS_sample, deltaS_fit)
a_mg <- coef(getFitSd(dfmg_agg))
a_mg <- coef(getFitSd(dfmg_agg)) # a = 1.54
# Plotting the data points, and fitted curve
plot(dfmg_agg$xbar, dfmg_agg$sd_sample, main = "Fitting the Function s = a * xbar * (1 - xbar)",
xlab = "Mean (xbar)", ylab = "Standard Deviation (s)", pch = 16)
# Adding the fitted curve
curve(coef(getFitSd(dfus_agg)) * x * (1 - x), add = TRUE, col = "orange", lwd = 2)
###### Fitting function for the sd. Model s = a.xbar.(1-xbar)
# function to get the value of the coeff a
getFitSd <- function(data){
d1 <- data[1,]; a_start = d1$sd_sample / (d1$xbar * (1 - d1$xbar))
fit <- nls( sd_sample ~ a * xbar * (1-xbar), data = data, start = list(a = a_start))
return(fit)
}
###### Fitting function for the sd. Model s = a.xbar.(1-xbar)
# function to get the value of the coeff a
getFitSd <- function(data){
d1 <- data[1,]; a_start = d1$sd_sample / (d1$xbar * (1 - d1$xbar))
fit <- nls( sd_sample ~ a * xbar * (1-xbar), data = data, start = list(a = a_start))
return(fit)
}
getFitSd(dfmg_agg)
a_mg <- coef(getFitSd(dfmg_agg)) # a = 1.536
# Plotting the data points, and fitted curve
plot(dfmg_agg$xbar, dfmg_agg$sd_sample, main = "Fitting the Function s = a * xbar * (1 - xbar)",
xlab = "Mean (xbar)", ylab = "Standard Deviation (s)", pch = 16)
# Adding the fitted curve
curve(coef(getFitSd(dfus_agg)) * x * (1 - x), add = TRUE, col = "orange", lwd = 2)
# Adding the fitted curve
curve(coef(getFitSd(dfmg_agg)) * x * (1 - x), add = TRUE, col = "orange", lwd = 2)
a_mg <- coef(getFitSd(dfmg_agg)) # a = 1.536
# Plotting the data points, and fitted curve
plot(dfmg_agg$xbar, dfmg_agg$sd_sample, main = "Fitting the Function s = a * xbar * (1 - xbar)",
xlab = "Mean (xbar)", ylab = "Standard Deviation (s)", pch = 16)
# Adding the fitted curve
curve(coef(getFitSd(dfmg_agg)) * x * (1 - x), add = TRUE, col = "orange", lwd = 2)
dfmg_agg <- dfmg %>% group_by(concept, color) %>% summarise(xbar = mean(rating), sd_sample = sd(rating), .groups = 'drop')
a_mg <- coef(getFitSd(dfmg_agg)) # a = 1.536
# Plotting the data points, and fitted curve
plot(dfmg_agg$xbar, dfmg_agg$sd_sample, main = "Fitting the Function s = a * xbar * (1 - xbar)",
xlab = "Mean (xbar)", ylab = "Standard Deviation (s)", pch = 16)
curve(coef(getFitSd(dfmg_agg)) * x * (1 - x), add = TRUE, col = "orange", lwd = 2)
xMg <- getXvalues(dfmg_agg, concept_pairs, color_pairs, a_mg) %>% mutate(deltaX = (xbar1 + xbar4) - (xbar2 + xbar3))
View(xMg)
deltaS_mg <- getDeltaS(xMg) %>% select(concept1, concept2, color1, color2, deltaS_sample, deltaS_fit)
