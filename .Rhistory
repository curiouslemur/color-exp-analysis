jobEn = c("musician", "infographist", "secretary", "physician", "driver")
mgdem$profession <- replace(mgdem$professionFr,
mgdem$professionFr %in% jobFr,
jobEn[match(mgdem$professionFr[mgdem$professionFr %in% jobFr], jobFr)])
rm(jobFr, jobEn)
# Chunk 3: MG data
mgdf1 <- read.csv("data/exp1/csv/clean/mg-p1.csv", encoding = "UTF-8")
mgdf2 <- read.csv("data/exp1/csv/clean/mg-p2.csv", encoding = "UTF-8")
mgdf3 <- read.csv("data/exp1/csv/clean/mg-p3.csv", encoding = "UTF-8")
mgdf123 <- rbind(mgdf1, mgdf2, mgdf3)
mgdf <- mgdf123 %>% filter(ID %in% unique(mgdem$sessionID))
mgdf <- translateConcepts(mgdf, conceptListFr3, conceptListEn3))
# Chunk 1
source(file = './utils/exp1-utils.R')  # loads all necessary packages //NOTE: some packages
source(file = './utils/stimuli.R')
# Chunk 2: MG demography
mgdem1 <- read.csv("data/exp1/csv/clean/mg-dem-p1.csv", encoding = "UTF-8")
mgdem2 <- read.csv("data/exp1/csv/clean/mg-dem-p2.csv", encoding = "UTF-8")
mgdem3 <- read.csv("data/exp1/csv/clean/mg-dem-p3.csv", encoding = "UTF-8")
mgdem123 <- rbind(mgdem1, mgdem2, mgdem3)
mgdem <- mgdem123 %>% filter(progressBlock == 14, progressColor == 37)
rm(mgdem1, mgdem2, mgdem3, mgdem123)
## fixing details
mgdem <- mgdem %>%
rename(professionFr = profession) %>%
mutate(profession = professionFr, .after = professionFr) %>%
mutate(profession = replace(profession, profession %in% c("musicien"), "musician")) %>%
mutate(profession = replace(profession, profession %in% c("chauffeur"), "driver"))
# replace job names in FR to EN. Inspired by the function translateConcepts
jobFr = c("musicien", "infographiste", "secretaire", "medecin", "chauffeur")
jobEn = c("musician", "infographist", "secretary", "physician", "driver")
mgdem$profession <- replace(mgdem$professionFr,
mgdem$professionFr %in% jobFr,
jobEn[match(mgdem$professionFr[mgdem$professionFr %in% jobFr], jobFr)])
rm(jobFr, jobEn)
# Chunk 3: MG data
mgdf1 <- read.csv("data/exp1/csv/clean/mg-p1.csv", encoding = "UTF-8")
mgdf2 <- read.csv("data/exp1/csv/clean/mg-p2.csv", encoding = "UTF-8")
mgdf3 <- read.csv("data/exp1/csv/clean/mg-p3.csv", encoding = "UTF-8")
mgdf123 <- rbind(mgdf1, mgdf2, mgdf3)
mgdf <- mgdf123 %>% filter(ID %in% unique(mgdem$sessionID))
mgdf <- translateConcepts(mgdf, conceptListFr3, conceptListEn3)
mgdf$expCountry = "mdg"
mgdf$rating = round(mgdf$ans/100, digits = 3)
rm(mgdf1, mgdf2, mgdf3, mgdf123)
# Chunk 4: US demography
usdem1 <- read.csv("data/exp1/csv/clean/us-dem-p1.csv", encoding = "UTF-8")
usdem2 <- read.csv("data/exp1/csv/clean/us-dem-p2.csv", encoding = "UTF-8")
usdem3 <- read.csv("data/exp1/csv/clean/us-dem-p3.csv", encoding = "UTF-8")
usdem3alt <- read.csv("data/exp1/csv/clean/us-dem-p3-alt.csv", encoding = "UTF-8")
usdem123 <- rbind(usdem1, usdem2, usdem3, usdem3alt)
usdem <- usdem123 %>% filter(progressBlock == 14, progressColor == 37)
usdem <- usdem %>% mutate(gender = replace(gender, gender %in% c("m"), "male"))
rm(usdem1, usdem2, usdem3, usdem3alt, usdem123)
# Chunk 5: US data
usdf1 <- read.csv("data/exp1/csv/clean/us-p1.csv", encoding = "UTF-8")
usdf2 <- read.csv("data/exp1/csv/clean/us-p2.csv", encoding = "UTF-8")
usdf3 <- read.csv("data/exp1/csv/clean/us-p3.csv", encoding = "UTF-8")
usdf3alt <- read.csv("data/exp1/csv/clean/us-p3-alt.csv", encoding = "UTF-8")
usdf123 <- rbind(usdf1, usdf2, usdf3, usdf3alt)
usdf <- usdf123 %>% filter(ID %in% unique(usdem$sessionID))
usdf$expCountry <- 'usa'
usdf$rating <- round(mgdf$ans/100, digits = 3)
rm(usdf1, usdf2, usdf3, usdf3alt, usdf123)
# Chunk 6: write data
write_csv(usdem, "data/exp1/csv/2026/us-dem.csv")
write_csv(usdf, "data/exp1/csv/2026/us-df.csv")
write_csv(mgdem, "data/exp1/csv/2026/mg-dem.csv")
write_csv(mgdf, "data/exp1/csv/2026/mg-df.csv")
# Chunk 7
mgdf_w <- mgdf %>% group_by(concept, color) %>%
summarize(weight = round(mean(rating), digits = 4),
se = round(sd(rating)/sqrt(length(rating)), digits = 4), .groups = 'drop') # standard error
mgdf_w <- full_join(mgdf_w, bcp37hex, by = "color") %>% mutate(barStroke = ifelse(color == "WH", "#000000", hex)) # barStroke is the color of the stroke of the bar when plotting. Stroke is black for white bars
mgdf_w$expCountry = "mdg"
#####
usdf_w <- usdf %>% group_by(concept, color) %>%
summarize(weight = round(mean(rating), digits = 4),
se = round(sd(rating)/sqrt(length(rating)), digits = 4), .groups = 'drop') # standard error
usdf_w <- full_join(usdf_w, bcp37hex, by = "color") %>% mutate(barStroke = ifelse(color == "WH", "#000000", hex))
usdf_w$expCountry = 'usa'
# Chunk 8: write data with weights
write_csv(usdf_w, "data/exp1/csv/2026/us-df-weight.csv")
write_csv(mgdf_w, "data/exp1/csv/2026/mg-df-weight.csv")
## Association weight MDG
mgdf_w$con = factor(mgdf_w$concept, levels=conceptListEn3) # to order the facet strips
View(mgdf_w)
p1 <- plotWeight_Err(mgdf_w, "Mean weight of assoc, lib: BCP37, MDG"); p1
"a"+"b"
knitr::opts_chunk$set(echo = TRUE)
source(file = './utils/exp1-utils.R')  # loads all necessary packages
source(file = './utils/stimuli.R')
dataPath = "data/exp1/csv/2026/"
usdf = read_csv(paste(dataPath, "mg-dem.csv", sep = ''))
usdem = read_csv(paste(dataPath, "mg-dem.csv", sep = ''))
mgdem = read_csv(paste(dataPath, "mg-dem.csv", sep = ''))
mgdf = read_csv(paste(dataPath, "mg-df.csv", sep = ''))
mgdf_w = read_csv(paste(dataPath, "mg-df-weight.csv", sep = ''))
usdem = read_csv(paste(dataPath, "us-dem.csv", sep = ''))
usdf = read_csv(paste(dataPath, "us-df.csv", sep = ''))
usdf_w = read_csv(paste(dataPath, "us-df-weight.csv", sep = ''))
rm(conceptListEn1, conceptListEn2, conceptListFr1, conceptListFr2)
rm(dataPath)
## Association weight MDG
mgdf_w$con = factor(mgdf_w$concept, levels=conceptListEn3) # to order the facet strips
p1 <- plotWeight_Err(mgdf_w, "Mean weight of assoc, lib: BCP37, MDG"); p1
## Association weight USA
usdf_w$con = factor(usdf_w$concept, levels=conceptListEn3) # to order the facet strips
p2 <- plotWeight_Err(usdf_w, "Mean weight of assoc., lib: BCP37, USA") +
theme(axis.title.y = element_blank(), axis.text.y = element_blank()); p2
View(bcp37hex)
p2 <- plotWeight_Err(usdf_w, "Mean weight of assoc., lib: BCP37, USA") +
theme(axis.title.y = element_blank(), axis.text.y = element_blank()); p2
p12 <- grid.arrange(p1, p2, nrow = 1)
ggsave(file="./fig/weight-mg.png", plot = p1, width=10, height=16)
ggsave(file="./fig/weight-us.png", plot = p2, width=10, height=16)
ggsave(file="./fig/weight-both.png", plot = p12, width=10, height=16)
unique(mgdf_w$concept)
# Chunk 1
source(file = './utils/exp1-utils.R')  # loads all necessary packages //NOTE: some packages
source(file = './utils/stimuli.R')
# Chunk 2: MG demography
mgdem1 <- read.csv("data/exp1/csv/clean/mg-dem-p1.csv", encoding = "UTF-8")
mgdem2 <- read.csv("data/exp1/csv/clean/mg-dem-p2.csv", encoding = "UTF-8")
mgdem3 <- read.csv("data/exp1/csv/clean/mg-dem-p3.csv", encoding = "UTF-8")
mgdem123 <- rbind(mgdem1, mgdem2, mgdem3)
mgdem <- mgdem123 %>% filter(progressBlock == 14, progressColor == 37)
rm(mgdem1, mgdem2, mgdem3, mgdem123)
## fixing details
mgdem <- mgdem %>%
rename(professionFr = profession) %>%
mutate(profession = professionFr, .after = professionFr) %>%
mutate(profession = replace(profession, profession %in% c("musicien"), "musician")) %>%
mutate(profession = replace(profession, profession %in% c("chauffeur"), "driver"))
# replace job names in FR to EN. Inspired by the function translateConcepts
jobFr = c("musicien", "infographiste", "secretaire", "medecin", "chauffeur")
jobEn = c("musician", "infographist", "secretary", "physician", "driver")
mgdem$profession <- replace(mgdem$professionFr,
mgdem$professionFr %in% jobFr,
jobEn[match(mgdem$professionFr[mgdem$professionFr %in% jobFr], jobFr)])
rm(jobFr, jobEn)
# Chunk 3: MG data
mgdf1 <- read.csv("data/exp1/csv/clean/mg-p1.csv", encoding = "UTF-8")
mgdf2 <- read.csv("data/exp1/csv/clean/mg-p2.csv", encoding = "UTF-8")
mgdf3 <- read.csv("data/exp1/csv/clean/mg-p3.csv", encoding = "UTF-8")
mgdf123 <- rbind(mgdf1, mgdf2, mgdf3)
mgdf <- mgdf123 %>% filter(ID %in% unique(mgdem$sessionID))
mgdf <- translateConcepts(mgdf, conceptListFr3, conceptListEn3)
mgdf$expCountry = "mdg"
mgdf$rating = round(mgdf$ans/100, digits = 3)
rm(mgdf1, mgdf2, mgdf3, mgdf123)
# Chunk 4: US demography
usdem1 <- read.csv("data/exp1/csv/clean/us-dem-p1.csv", encoding = "UTF-8")
usdem2 <- read.csv("data/exp1/csv/clean/us-dem-p2.csv", encoding = "UTF-8")
usdem3 <- read.csv("data/exp1/csv/clean/us-dem-p3.csv", encoding = "UTF-8")
usdem3alt <- read.csv("data/exp1/csv/clean/us-dem-p3-alt.csv", encoding = "UTF-8")
usdem123 <- rbind(usdem1, usdem2, usdem3, usdem3alt)
usdem <- usdem123 %>% filter(progressBlock == 14, progressColor == 37)
usdem <- usdem %>% mutate(gender = replace(gender, gender %in% c("m"), "male"))
rm(usdem1, usdem2, usdem3, usdem3alt, usdem123)
# Chunk 5: US data
usdf1 <- read.csv("data/exp1/csv/clean/us-p1.csv", encoding = "UTF-8")
usdf2 <- read.csv("data/exp1/csv/clean/us-p2.csv", encoding = "UTF-8")
usdf3 <- read.csv("data/exp1/csv/clean/us-p3.csv", encoding = "UTF-8")
usdf3alt <- read.csv("data/exp1/csv/clean/us-p3-alt.csv", encoding = "UTF-8")
usdf123 <- rbind(usdf1, usdf2, usdf3, usdf3alt)
usdf <- usdf123 %>% filter(ID %in% unique(usdem$sessionID))
usdf$expCountry <- 'usa'
usdf$rating <- round(mgdf$ans/100, digits = 3)
rm(usdf1, usdf2, usdf3, usdf3alt, usdf123)
# Chunk 6: write data
write_csv(usdem, "data/exp1/csv/2026/us-dem.csv")
write_csv(usdf, "data/exp1/csv/2026/us-df.csv")
write_csv(mgdem, "data/exp1/csv/2026/mg-dem.csv")
write_csv(mgdf, "data/exp1/csv/2026/mg-df.csv")
# Chunk 7
mgdf_w <- mgdf %>% group_by(concept, color) %>%
summarize(weight = round(mean(rating), digits = 4),
se = round(sd(rating)/sqrt(length(rating)), digits = 4), .groups = 'drop') # standard error
mgdf_w <- full_join(mgdf_w, bcp37hex, by = "color") %>% mutate(barStroke = ifelse(color == "WH", "#000000", hex)) # barStroke is the color of the stroke of the bar when plotting. Stroke is black for white bars
mgdf_w$expCountry = "mdg"
#####
usdf_w <- usdf %>% group_by(concept, color) %>%
summarize(weight = round(mean(rating), digits = 4),
se = round(sd(rating)/sqrt(length(rating)), digits = 4), .groups = 'drop') # standard error
usdf_w <- full_join(usdf_w, bcp37hex, by = "color") %>% mutate(barStroke = ifelse(color == "WH", "#000000", hex))
usdf_w$expCountry = 'usa'
# Chunk 8: write data with weights
write_csv(usdf_w, "data/exp1/csv/2026/us-df-weight.csv")
write_csv(mgdf_w, "data/exp1/csv/2026/mg-df-weight.csv")
knitr::opts_chunk$set(echo = TRUE)
source(file = './utils/exp1-utils.R')  # loads all necessary packages
source(file = './utils/stimuli.R')
dataPath = "data/exp1/csv/2026/"
mgdem = read_csv(paste(dataPath, "mg-dem.csv", sep = ''))
mgdf = read_csv(paste(dataPath, "mg-df.csv", sep = ''))
mgdf_w = read_csv(paste(dataPath, "mg-df-weight.csv", sep = ''))
usdem = read_csv(paste(dataPath, "us-dem.csv", sep = ''))
usdf = read_csv(paste(dataPath, "us-df.csv", sep = ''))
usdf_w = read_csv(paste(dataPath, "us-df-weight.csv", sep = ''))
rm(dataPath)
## Association weight MDG
mgdf_w$con = factor(mgdf_w$concept, levels=conceptListEn3) # to order the facet strips
p1 <- plotWeight_Err(mgdf_w, "Mean weight of assoc, lib: BCP37, MDG"); p1
## Association weight USA
usdf_w$con = factor(usdf_w$concept, levels=conceptListEn3) # to order the facet strips
p2 <- plotWeight_Err(usdf_w, "Mean weight of assoc., lib: BCP37, USA") +
theme(axis.title.y = element_blank(), axis.text.y = element_blank()); p2
p12 <- grid.arrange(p1, p2, nrow = 1)
ggsave(file="./fig/weight-mg.png", plot = p1, width=10, height=16)
ggsave(file="./fig/weight-us.png", plot = p2, width=10, height=16)
ggsave(file="./fig/weight-both.png", plot = p12, width=10, height=16)
knitr::opts_chunk$set(echo = TRUE)
source(file = './utils/exp1-utils.R')  # loads all necessary packages
dataPath = "data/exp1/csv/2026/"
mgdem = read_csv(paste(dataPath, "mg-dem.csv", sep = ''))
mgdf = read_csv(paste(dataPath, "mg-df.csv", sep = ''))
mgdf_w = read_csv(paste(dataPath, "mg-df-weight.csv", sep = ''))
usdem = read_csv(paste(dataPath, "us-dem.csv", sep = ''))
usdf = read_csv(paste(dataPath, "us-df.csv", sep = ''))
usdf_w = read_csv(paste(dataPath, "us-df-weight.csv", sep = ''))
rm(dataPath)
source(file = './utils/exp1-utils.R')  # loads all necessary packages //NOTE: some packages
source(file = './utils/stimuli.R')
mgdem1 <- read.csv("data/exp1/csv/clean/mg-dem-p1.csv", encoding = "UTF-8")
mgdem2 <- read.csv("data/exp1/csv/clean/mg-dem-p2.csv", encoding = "UTF-8")
mgdem3 <- read.csv("data/exp1/csv/clean/mg-dem-p3.csv", encoding = "UTF-8")
mgdem123 <- rbind(mgdem1, mgdem2, mgdem3)
mgdem <- mgdem123 %>% filter(progressBlock == 14, progressColor == 37)
rm(mgdem1, mgdem2, mgdem3, mgdem123)
## fixing details
mgdem <- mgdem %>%
rename(professionFr = profession) %>%
mutate(profession = professionFr, .after = professionFr) %>%
mutate(profession = replace(profession, profession %in% c("musicien"), "musician")) %>%
mutate(profession = replace(profession, profession %in% c("chauffeur"), "driver"))
# replace job names in FR to EN. Inspired by the function translateConcepts
jobFr = c("musicien", "infographiste", "secretaire", "medecin", "chauffeur")
jobEn = c("musician", "infographist", "secretary", "physician", "driver")
mgdem$profession <- replace(mgdem$professionFr,
mgdem$professionFr %in% jobFr,
jobEn[match(mgdem$professionFr[mgdem$professionFr %in% jobFr], jobFr)])
rm(jobFr, jobEn)
mgdf1 <- read.csv("data/exp1/csv/clean/mg-p1.csv", encoding = "UTF-8")
mgdf2 <- read.csv("data/exp1/csv/clean/mg-p2.csv", encoding = "UTF-8")
mgdf3 <- read.csv("data/exp1/csv/clean/mg-p3.csv", encoding = "UTF-8")
mgdf123 <- rbind(mgdf1, mgdf2, mgdf3)
mgdf <- mgdf123 %>% filter(ID %in% unique(mgdem$sessionID))
mgdf <- translateConcepts(mgdf, conceptListFr3, conceptListEn3)
mgdf$expCountry = "mdg"
mgdf$rating = round(mgdf$ans/100, digits = 3)
rm(mgdf1, mgdf2, mgdf3, mgdf123)
usdem1 <- read.csv("data/exp1/csv/clean/us-dem-p1.csv", encoding = "UTF-8")
usdem2 <- read.csv("data/exp1/csv/clean/us-dem-p2.csv", encoding = "UTF-8")
usdem3 <- read.csv("data/exp1/csv/clean/us-dem-p3.csv", encoding = "UTF-8")
usdem3alt <- read.csv("data/exp1/csv/clean/us-dem-p3-alt.csv", encoding = "UTF-8")
usdem123 <- rbind(usdem1, usdem2, usdem3, usdem3alt)
usdem <- usdem123 %>% filter(progressBlock == 14, progressColor == 37)
usdem <- usdem %>% mutate(gender = replace(gender, gender %in% c("m"), "male"))
rm(usdem1, usdem2, usdem3, usdem3alt, usdem123)
unique(usdem$sessionID)
View(usdf)
View(mgdf)
# Chunk 1
source(file = './utils/exp1-utils.R')  # loads all necessary packages //NOTE: some packages
source(file = './utils/stimuli.R')
# Chunk 2: MG demography
mgdem1 <- read.csv("data/exp1/csv/clean/mg-dem-p1.csv", encoding = "UTF-8")
mgdem2 <- read.csv("data/exp1/csv/clean/mg-dem-p2.csv", encoding = "UTF-8")
mgdem3 <- read.csv("data/exp1/csv/clean/mg-dem-p3.csv", encoding = "UTF-8")
mgdem123 <- rbind(mgdem1, mgdem2, mgdem3)
mgdem <- mgdem123 %>% filter(progressBlock == 14, progressColor == 37)
rm(mgdem1, mgdem2, mgdem3, mgdem123)
## fixing details
mgdem <- mgdem %>%
rename(professionFr = profession) %>%
mutate(profession = professionFr, .after = professionFr) %>%
mutate(profession = replace(profession, profession %in% c("musicien"), "musician")) %>%
mutate(profession = replace(profession, profession %in% c("chauffeur"), "driver"))
# replace job names in FR to EN. Inspired by the function translateConcepts
jobFr = c("musicien", "infographiste", "secretaire", "medecin", "chauffeur")
jobEn = c("musician", "infographist", "secretary", "physician", "driver")
mgdem$profession <- replace(mgdem$professionFr,
mgdem$professionFr %in% jobFr,
jobEn[match(mgdem$professionFr[mgdem$professionFr %in% jobFr], jobFr)])
rm(jobFr, jobEn)
# Chunk 3: MG data
mgdf1 <- read.csv("data/exp1/csv/clean/mg-p1.csv", encoding = "UTF-8")
mgdf2 <- read.csv("data/exp1/csv/clean/mg-p2.csv", encoding = "UTF-8")
mgdf3 <- read.csv("data/exp1/csv/clean/mg-p3.csv", encoding = "UTF-8")
mgdf123 <- rbind(mgdf1, mgdf2, mgdf3)
mgdf <- mgdf123 %>% filter(ID %in% unique(mgdem$sessionID))
mgdf <- translateConcepts(mgdf, conceptListFr3, conceptListEn3)
mgdf$expCountry = "mdg"
mgdf$rating = round(mgdf$ans/100, digits = 3)
rm(mgdf1, mgdf2, mgdf3, mgdf123)
# Chunk 4: US demography
usdem1 <- read.csv("data/exp1/csv/clean/us-dem-p1.csv", encoding = "UTF-8")
usdem2 <- read.csv("data/exp1/csv/clean/us-dem-p2.csv", encoding = "UTF-8")
usdem3 <- read.csv("data/exp1/csv/clean/us-dem-p3.csv", encoding = "UTF-8")
usdem3alt <- read.csv("data/exp1/csv/clean/us-dem-p3-alt.csv", encoding = "UTF-8")
usdem123 <- rbind(usdem1, usdem2, usdem3, usdem3alt)
usdem <- usdem123 %>% filter(progressBlock == 14, progressColor == 37)
usdem <- usdem %>% mutate(gender = replace(gender, gender %in% c("m"), "male"))
rm(usdem1, usdem2, usdem3, usdem3alt, usdem123)
# Chunk 5: US data
usdf1 <- read.csv("data/exp1/csv/clean/us-p1.csv", encoding = "UTF-8")
usdf2 <- read.csv("data/exp1/csv/clean/us-p2.csv", encoding = "UTF-8")
usdf3 <- read.csv("data/exp1/csv/clean/us-p3.csv", encoding = "UTF-8")
usdf3alt <- read.csv("data/exp1/csv/clean/us-p3-alt.csv", encoding = "UTF-8")
usdf123 <- rbind(usdf1, usdf2, usdf3, usdf3alt)
usdf <- usdf123 %>% filter(ID %in% unique(usdem$sessionID))
usdf$expCountry <- 'usa'
usdf$rating <- round(usdf$ans/100, digits = 3)
rm(usdf1, usdf2, usdf3, usdf3alt, usdf123)
# Chunk 6: write data
write_csv(usdem, "data/exp1/csv/2026/us-dem.csv")
write_csv(usdf, "data/exp1/csv/2026/us-df.csv")
write_csv(mgdem, "data/exp1/csv/2026/mg-dem.csv")
write_csv(mgdf, "data/exp1/csv/2026/mg-df.csv")
# Chunk 7
mgdf_w <- mgdf %>% group_by(concept, color) %>%
summarize(weight = round(mean(rating), digits = 4),
se = round(sd(rating)/sqrt(length(rating)), digits = 4), .groups = 'drop') # standard error
mgdf_w <- full_join(mgdf_w, bcp37hex, by = "color") %>% mutate(barStroke = ifelse(color == "WH", "#000000", hex)) # barStroke is the color of the stroke of the bar when plotting. Stroke is black for white bars
mgdf_w$expCountry = "mdg"
#####
usdf_w <- usdf %>% group_by(concept, color) %>%
summarize(weight = round(mean(rating), digits = 4),
se = round(sd(rating)/sqrt(length(rating)), digits = 4), .groups = 'drop') # standard error
usdf_w <- full_join(usdf_w, bcp37hex, by = "color") %>% mutate(barStroke = ifelse(color == "WH", "#000000", hex))
usdf_w$expCountry = 'usa'
# Chunk 8: write data with weights
write_csv(usdf_w, "data/exp1/csv/2026/us-df-weight.csv")
write_csv(mgdf_w, "data/exp1/csv/2026/mg-df-weight.csv")
knitr::opts_chunk$set(echo = TRUE)
source(file = './utils/exp1-utils.R')  # loads all necessary packages
source(file = './utils/stimuli.R')
dataPath = "data/exp1/csv/2026/"
mgdem = read_csv(paste(dataPath, "mg-dem.csv", sep = ''))
mgdf = read_csv(paste(dataPath, "mg-df.csv", sep = ''))
mgdf_w = read_csv(paste(dataPath, "mg-df-weight.csv", sep = ''))
usdem = read_csv(paste(dataPath, "us-dem.csv", sep = ''))
usdf = read_csv(paste(dataPath, "us-df.csv", sep = ''))
usdf_w = read_csv(paste(dataPath, "us-df-weight.csv", sep = ''))
rm(dataPath)
## Association weight MDG
mgdf_w$con = factor(mgdf_w$concept, levels=conceptListEn3) # to order the facet strips
p1 <- plotWeight_Err(mgdf_w, "Mean weight of assoc, lib: BCP37, MDG"); p1
## Association weight USA
usdf_w$con = factor(usdf_w$concept, levels=conceptListEn3) # to order the facet strips
p2 <- plotWeight_Err(usdf_w, "Mean weight of assoc., lib: BCP37, USA") +
theme(axis.title.y = element_blank(), axis.text.y = element_blank()); p2
p12 <- grid.arrange(p1, p2, nrow = 1)
ggsave(file="./fig/weight-mg.png", plot = p1, width=10, height=16)
ggsave(file="./fig/weight-us.png", plot = p2, width=10, height=16)
ggsave(file="./fig/weight-both.png", plot = p12, width=10, height=16)
# raw data exported from exp1-data-prep.R
usdf = read_csv("data/exp1/csv/clean/p3-us.csv")
length(unique(usdf$ID))
length(unique(mgdf$ID))
# Unique pairs of concepts and pairs of colors without repetition
# ie. {red, yellow} == {yellow, red}
concept_pairs <- as.data.frame(t(combn(unique(usdf$concept), 2))) %>% rename(concept1 = V1, concept2 = V2)
color_pairs <- as.data.frame(t(combn(unique(mgdf$color), 2))) %>% rename(color1 = V1, color2 = V2)
?nls
source(file = './utils/exp1-analysis-utils.R')
source("~/Desktop/__WPI/__proj-color/color-exp-analysis-R/utils/exp1-analysis-utils.R")
# Aggregated data (x = average rating for each color of each concept)
usdf_agg <- usdf %>% group_by(concept, color) %>% summarise(xbar = mean(rating), sd_sample = sd(rating), .groups = 'drop')
a_us <- coef(getFitSd(usdf_agg)) # a = 1.384426
# Plotting the data points, and fitted curve
plot(usdf_agg$xbar, usdf_agg$sd_sample, main = "Fit for model s = a * xbar * (1 - xbar)",
xlab = "Mean (xbar)", ylab = "Standard Deviation (s)", pch = 16)
curve(coef(getFitSd(usdf_agg)) * x * (1 - x), add = TRUE, col = "orange", lwd = 2)
a_us2 <- coef(getFitSd2(usdf_agg))
plot(usdf_agg$xbar, usdf_agg$sd_sample, main = "Fit for model s = a * xbar^b",
xlab = "Mean (xbar)", ylab = "Standard Deviation (s)", pch = 16)
curve(coef(getFitSd2(usdf_agg))[1] * x^coef(getFitSd2(usdf_agg))[2], add = TRUE, col = "red", lwd = 2)
a_us2
xUs <- getXvalues(usdf_agg, concept_pairs, color_pairs, a_us) %>% mutate(deltaX = (xbar1 + xbar4) - (xbar2 + xbar3))
source("~/Desktop/__WPI/__proj-color/color-exp-analysis-R/utils/exp1-analysis-utils.R")
# xUs <- getXvalues(usdf_agg, concept_pairs, color_pairs, a_us) %>% mutate(deltaX = (xbar1 + xbar4) - (xbar2 + xbar3))
xUs2 <- getXvalues_opt(usdf_agg, concept_pairs, color_pairs, a_us) %>% mutate(deltaX = (xbar1 + xbar4) - (xbar2 + xbar3))
rm(xUs2)
# xUs <- getXvalues(usdf_agg, concept_pairs, color_pairs, a_us) %>% mutate(deltaX = (xbar1 + xbar4) - (xbar2 + xbar3))
xUs2 <- getXvalues_opt(usdf_agg, concept_pairs, color_pairs, a_us) %>% mutate(deltaX = (xbar1 + xbar4) - (xbar2 + xbar3))
deltaS_us <- getDeltaS(xUs2) %>% select(concept1, concept2, color1, color2, deltaS_sample, deltaS_fit)
mgdf_agg <- mgdf %>% group_by(concept, color) %>% summarise(xbar = mean(rating), sd_sample = sd(rating), .groups = 'drop')
a_mg <- coef(getFitSd(mgdf_agg)) # a = 1.536
# Plotting the data points, and fitted curve
plot(mgdf_agg$xbar, mgdf_agg$sd_sample, main = "Fit for the Function s = a * xbar * (1 - xbar)",
xlab = "Mean (xbar)", ylab = "Standard Deviation (s)", pch = 16)
curve(coef(getFitSd(mgdf_agg)) * x * (1 - x), add = TRUE, col = "orange", lwd = 2)
a_mg2 <- coef(getFitSd2(mgdf_agg))
plot(mgdf_agg$xbar, mgdf_agg$sd_sample, main = "Fit for model s = a * xbar^b",
xlab = "Mean (xbar)", ylab = "Standard Deviation (s)", pch = 16)
curve(coef(getFitSd2(mgdf_agg))[1] * x^coef(getFitSd2(mgdf_agg))[2], add = TRUE, col = "red", lwd = 2)
# xMg <- getXvalues(mgdf_agg, concept_pairs, color_pairs, a_mg) %>% mutate(deltaX = (xbar1 + xbar4) - (xbar2 + xbar3))
xMg2 <- getXvalues_opt(mgdf_agg, concept_pairs, color_pairs, a_mg) %>% mutate(deltaX = (xbar1 + xbar4) - (xbar2 + xbar3))
deltaS_mg <- getDeltaS(xMg2) %>% select(concept1, concept2, color1, color2, deltaS_sample, deltaS_fit)
dsmg <- deltaS_mg %>% select(-deltaS_sample) %>% rename(deltaSmg = deltaS_fit)
dsus <- deltaS_us %>% select(-deltaS_sample) %>% rename(deltaSus = deltaS_fit)
# Lower and Higher thresholds for deltaS
dsL = 0.1; dsH = 0.9
getPairs <- function(dsL, dsH){
dsmgL = filter(dsmg, deltaSmg <= dsL) %>% select(-deltaSmg);
dsmgH = filter(dsmg, deltaSmg >= dsH) %>% select(-deltaSmg)
dsusL = filter(dsus, deltaSus <= dsL) %>% select(-deltaSus);
dsusH = filter(dsus, deltaSus >= dsH) %>% select(-deltaSus)
mgL_usH = inner_join(dsmgL, dsusH, by = c('concept1', 'concept2', 'color1', 'color2')) %>% # common rows between the two dataframes
rename(mgL_usH1 = color1, mgL_usH2 = color2)
mgH_usH = inner_join(dsmgH, dsusH, by = c('concept1', 'concept2', 'color1', 'color2')) %>%
rename(mgH_usH1 = color1, mgH_usH2 = color2)
mgL_usL = inner_join(dsmgL, dsusL, by = c('concept1', 'concept2', 'color1', 'color2')) %>%
rename(mgL_usL1 = color1, mgL_usL2 = color2)
mgH_usL = inner_join(dsmgH, dsusL, by = c('concept1', 'concept2', 'color1', 'color2')) %>%
rename(mgH_usL1 = color1, mgH_usL2 = color2)
final <- mgL_usH %>%
full_join(mgH_usH, by = c('concept1', 'concept2'), relationship = "many-to-many") %>%
full_join(mgL_usL, by = c('concept1', 'concept2'), relationship = "many-to-many") %>%
full_join(mgH_usL, by = c('concept1', 'concept2'), relationship = "many-to-many")#  %>% drop_na()
return(final)
}
final <- getPairs(0.1, 0.7)  %>% drop_na()
View(mgdem)
View(final)
scatterDf <- data.frame()
for (low in c(0.1, 0.2, 0.3)){
for (hi in c(0.9, 0.8, 0.7)){
tmp <- getPairs(low, hi)
a <- tmp %>% group_by(concept1, concept2) %>% summarize(
n_con_pair = n(),
mgL_usL = sum(!is.na(mgL_usL1)), mgL_usH = sum(!is.na(mgL_usH1)),
mgH_usL = sum(!is.na(mgH_usL1)), mgH_usH = sum(!is.na(mgH_usH1)), .groups = 'drop')
a$dsLow = low; a$dsHi = hi
scatterDf <- rbind(scatterDf, a)
}
}
View(scatterDf)
df <- final %>% filter(mgL_usH1 == "WH", mgL_usH2 == "DP", mgH_usH1=="DG", mgH_usH2 == "BK")
json_list <- list()
for (i in 1:nrow(df)) {
# Extract values for the current row
row_data <- df[i, ]
# Define the JSON structure for the current row
json_data <- list(
concept1 = row_data$concept1,
concept2 = row_data$concept2,
mgL_usH = list(row_data$mgL_usH1, row_data$mgL_usH2),
mgH_usH = list(row_data$mgH_usH1, row_data$mgH_usH2),
mgL_usL = list(row_data$mgL_usL1, row_data$mgL_usL2),
mgH_usL = list(row_data$mgH_usL1, row_data$mgH_usL2))
json_list[[i]] <- json_data
}
# Convert the entire list to JSON and write it to a single file
json_string <- toJSON(json_list, pretty = TRUE, auto_unbox = TRUE)
?toJson
?toJSON
library(jsonlite)
json_list <- list()
for (i in 1:nrow(df)) {
# Extract values for the current row
row_data <- df[i, ]
# Define the JSON structure for the current row
json_data <- list(
concept1 = row_data$concept1,
concept2 = row_data$concept2,
mgL_usH = list(row_data$mgL_usH1, row_data$mgL_usH2),
mgH_usH = list(row_data$mgH_usH1, row_data$mgH_usH2),
mgL_usL = list(row_data$mgL_usL1, row_data$mgL_usL2),
mgH_usL = list(row_data$mgH_usL1, row_data$mgH_usL2))
json_list[[i]] <- json_data
}
# Convert the entire list to JSON and write it to a single file
json_string <- toJSON(json_list, pretty = TRUE, auto_unbox = TRUE)
print(json_string)
write(json_string, file = "output/final-12-2026.json")
df2 <- bcp37
# Function to create JSON-like entry
create_json_entry <- function(code) {
entry <- df2 %>% filter(color == code)
if (nrow(entry) > 0) {
return(list(color = code, hex = entry$hex, L = entry$L, a = entry$a, b = entry$b))
# return(list(color = code, hex = entry$hex, L = entry$L))
} else {
return(NULL)  # Return NULL if the color code doesn't exist in df2
}
}
# Replace color codes with JSON entries
df_replaced <- df %>%
mutate(across(starts_with("mg"), ~map(.x, create_json_entry)))
# Convert the transformed dataframe back to JSON
output_json <- toJSON(df_replaced, pretty = TRUE, auto_unbox = TRUE)
cat(output_json)
df_combined <- df_replaced %>%
mutate(mgL_usH = map2(mgL_usH1, mgL_usH2, ~ list(.x, .y))) %>%
mutate(mgL_usL = map2(mgL_usL1, mgL_usL2, ~ list(.x, .y))) %>%
mutate(mgH_usH = map2(mgH_usH1, mgH_usH2, ~ list(.x, .y))) %>%
mutate(mgH_usL = map2(mgH_usL1, mgH_usL2, ~ list(.x, .y))) %>%
select(-mgL_usH1, -mgL_usH2, -mgL_usL1, -mgL_usL2, -mgH_usH1, -mgH_usH2, -mgH_usL1, -mgH_usL2 )  # Remove the original keys
# Convert the modified dataframe back to JSON
output_json <- toJSON(df_combined, pretty = TRUE, auto_unbox = TRUE)
# Print the resulting JSON
cat(output_json)
write(output_json, file = "output/full.json")
source(file = './utils/exp1-utils.R')  # loads all necessary packages //NOTE: some packages
source(file = './utils/stimuli.R')
```{r}
source(file = './utils/exp1-utils.R')  # loads all necessary packages //NOTE: some packages
source(file = './utils/stimuli.R')
```{r}
