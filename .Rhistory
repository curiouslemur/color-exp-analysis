rm(tmp)
rm(c, conc, i, j, mg, us)
# transform df_cat_... into dataframes
df_cat_emotion$cat <- NULL
df_cat_emotion$angry <- unlist(df_cat_emotion$angry)
unnest(df_cat_emotion)
unnest(df_cat_emotion, cols = c(angry, sad, happy, love))
as.data.table(df_cat_emotion)[, .(A = unlist(angry), B = unlist(happy), C = unlist(love), D = unlist(sad))]
library(data.table)
as.data.table(df_cat_emotion)[, .(A = unlist(angry), B = unlist(happy), C = unlist(love), D = unlist(sad))]
View(as.data.table(df_cat_emotion)[, .(A = unlist(angry), B = unlist(happy), C = unlist(love), D = unlist(sad))])
# Example vectors with different lengths
col1 <- c(1, 2, 3, 4)
col2 <- c(5, 6, 7)
col3 <- c(8, 9, 10, 11, 12)
# Create a dataframe with columns of different lengths, filling shorter columns with NA
data.frame(
col1 = c(col1, rep(NA, max(lengths(col1), lengths(col2), lengths(col3)) - length(col1))),
col2 = c(col2, rep(NA, max(lengths(col1), lengths(col2), lengths(col3)) - length(col2))),
col3 = c(col3, rep(NA, max(lengths(col1), lengths(col2), lengths(col3)) - length(col3)))
)
# Example vectors with different lengths
col1 <- c(1, 2, 3, 4)
col2 <- c(5, 6, 7)
col3 <- c(8, 9, 10, 11, 12)
# Create a dataframe with columns of different lengths, filling shorter columns with NA
data.frame(
col1 = c(col1, rep(NA, max(lengths(col1), lengths(col2), lengths(col3)) - length(col1))),
col2 = c(col2, rep(NA, max(lengths(col1), lengths(col2), lengths(col3)) - length(col2))),
col3 = c(col3, rep(NA, max(lengths(col1), lengths(col2), lengths(col3)) - length(col3)))
)
max(lengths(col1), lengths(col2), lengths(col3)) - length(col1)
max(lengths(col1), lengths(col2), lengths(col3))
max(length(col1), length(col2), length(col3))
# Example vectors with different lengths
col1 <- c(1, 2, 3, 4)
col2 <- c(5, 6, 7)
col3 <- c(8, 9, 10, 11, 12)
# Create a dataframe with columns of different lengths, filling shorter columns with NA
data.frame(
col1 = c(col1, rep(NA, max(length(col1), length(col2), length(col3)) - length(col1))),
col2 = c(col2, rep(NA, max(length(col1), length(col2), length(col3)) - length(col2))),
col3 = c(col3, rep(NA, max(length(col1), length(col2), length(col3)) - length(col3)))
)
# Print the resulting dataframe
print(df)
# Example vectors with different lengths
col1 <- c(1, 2, 3, 4)
col2 <- c(5, 6, 7)
col3 <- c(8, 9, 10, 11, 12)
# Create a dataframe with columns of different lengths, filling shorter columns with NA
View(data.frame(
col1 = c(col1, rep(NA, max(length(col1), length(col2), length(col3)) - length(col1))),
col2 = c(col2, rep(NA, max(length(col1), length(col2), length(col3)) - length(col2))),
col3 = c(col3, rep(NA, max(length(col1), length(col2), length(col3)) - length(col3)))
))
# Print the resulting dataframe
print(df)
e <- filter(df_cat, cat == "emotion")
e_angry <- filter(df_cat, cat == "emotion") $>$ select(concept)
e_angry <- filter(df_cat, cat == "emotion") %>% select(concept)
View(e)
View(e_angry)
e_angry <- filter(df_cat, cat == "emotion", concept == "angry") %>% select(rating)
View(e_angry)
e_angry <- filter(df_cat, cat == "emotion", concept == "angry") %>% select(rating) %>% rename(e_angry = rating)
View(e_angry)
happy <- filter(df_cat, cat == "emotion", concept == "happy") %>% select(rating) %>% rename(e_happy = rating)
angry <- filter(df_cat, cat == "emotion", concept == "angry") %>% select(rating, code) %>% rename(e_angry = rating)
happy <- filter(df_cat, cat == "emotion", concept == "happy") %>% select(rating, code) %>% rename(e_happy = rating)
happy <- filter(df_cat, cat == "emotion", concept == "happy") %>% select(rating, code) %>% rename(e_happy = rating)
View(full_join(angry, happy, by='code'))
View(right_join(angry, happy, by='code'))
a <- right_join(angry, happy, by='code')
View(a)
df_cat <- df %>% mutate(
cat = case_when(
concept %in% c('angry', 'happy', 'love', 'sad') ~ 'emotion',
concept %in% c("banana", "carrot", 'mango', 'peach') ~ 'food',
concept %in% c('comfort', 'justice', 'peace', 'safety') ~ 'abstract',
concept %in% c('drought', 'hurricane', 'lightning', 'sandstorm') ~ 'weather')) %>%
group_by(cat, concept, code) %>%
summarise(mean_rating = mean(rating))
View(df_cat)
rm(e, e_angry, e_happy)
rm(angry, happy)
rm(correlation_test)
rm(p_values, pd)
View(df_cat)
rm(df_cat_abstract, df_cat_emotion, df_cat_food, df_cat_pivot, df_cat_weather)
rm(new_df)
df_cat <- df %>% mutate(
cat = case_when(
concept %in% c('angry', 'happy', 'love', 'sad') ~ 'emotion',
concept %in% c("banana", "carrot", 'mango', 'peach') ~ 'food',
concept %in% c('comfort', 'justice', 'peace', 'safety') ~ 'abstract',
concept %in% c('drought', 'hurricane', 'lightning', 'sandstorm') ~ 'weather')) %>%
group_by(cat, concept, code) %>%
summarise(mean_rating = round(mean(rating), digits = 4))
View(df_cat)
df_cat_e <- df_cat %>% filter(cat == 'emotion')
View(df_cat_e)
df_cat_e <- df_cat %>% filter(cat == 'emotion') %>%
pivot_wider(id_cols = "cat", names_from = "concept", values_from = "mean_rating")
View(df_cat_e)
df_cat_e <- df_cat %>% filter(cat == 'emotion') %>%
pivot_wider(id_cols = c("cat", "code"), names_from = "concept", values_from = "mean_rating")
View(df_cat_e)
# Number of columns
num_cols <- ncol(df_cat_e)
rm(col1, col2. col3)
rm(col1, col2,col3)
df_cat_e <- select(df_cat_e, c('angry'))
View(df_cat_e)
### category: "emotion"
#### build pivoted dataframe | cat | code | angry | happy | love | sad |
df_cat_e <- df_cat %>% filter(cat == 'emotion') %>%
pivot_wider(id_cols = c("cat", "code"), names_from = "concept", values_from = "mean_rating")
df_cat_e <- select(df_cat_e, angry, happy, love, sad)
View(df_cat_e)
df_cat_e <- select(df_cat_e, c('angry', 'happy', 'love', 'sad')
df_cat_e <- select(df_cat_e, c('angry', 'happy', 'love', 'sad'))
# Number of columns
df_cat_e %>% select(angry)
df_cat <- df %>% mutate(
cat = case_when(
concept %in% c('angry', 'happy', 'love', 'sad') ~ 'emotion',
concept %in% c("banana", "carrot", 'mango', 'peach') ~ 'food',
concept %in% c('comfort', 'justice', 'peace', 'safety') ~ 'abstract',
concept %in% c('drought', 'hurricane', 'lightning', 'sandstorm') ~ 'weather')) %>%
group_by(cat, concept, code) %>%
summarise(mean_rating = round(mean(rating), digits = 4), .groups = 'drop')
### category: "emotion"
#### build pivoted dataframe | cat | code | angry | happy | love | sad |
df_cat_e <- df_cat %>% filter(cat == 'emotion') %>%
pivot_wider(id_cols = c("cat", "code"), names_from = "concept", values_from = "mean_rating")
# Number of columns
df_cat_e %>% select(angry, happy, love, sad)
# Number of columns
df_cat_e <- df_cat_e %>% select(angry, happy, love, sad)
num_cols <- ncol(df_cat_e)
# Create an empty matrix to store p-values
p_values <- matrix(NA, nrow = num_cols, ncol = num_cols)
# Loop through each pair of columns
for (i in 1:(num_cols - 1)) {
for (j in (i + 1):num_cols) {
# Calculate correlation test
correlation_test <- cor.test(df_cat_e[, i], df_cat_e[, j])
# Store the p-value
p_values[i, j] <- correlation_test$p.value
p_values[j, i] <- correlation_test$p.value
}
}
df_cat_e[, j]
class(df_cat_e[, j])
class(df_cat_e$angry)
class(df_cat_e[, 2])
class(df_cat_e)
df_cat_e <- as.data.frame(df_cat_e)
class(df_cat_e)
class(df_cat_e$angry)
class(df_cat_e[,1])
# Loop through each pair of columns
for (i in 1:(num_cols - 1)) {
for (j in (i + 1):num_cols) {
# Calculate correlation test
correlation_test <- cor.test(df_cat_e[, i], df_cat_e[, j])
# Store the p-value
p_values[i, j] <- correlation_test$p.value
p_values[j, i] <- correlation_test$p.value
}
}
# Apply Bonferroni correction
adjusted_p_values <- p.adjust(as.vector(p_values), method = "bonferroni")
# Reshape the adjusted p-values to a matrix
adjusted_p_matrix <- matrix(adjusted_p_values, nrow = num_cols, ncol = num_cols)
print(cor(df))
print(cor(df_cat_e))
print(adjusted_p_matrix)
print(cor(df_cat_e))
adjusted_p_values
View(data.frame(adj = adjusted_p_values))
print(cor(df_cat_e))
print(adjusted_p_matrix)
0.05/15
0.05/6
View(df_cat_e)
### computing pairwise correlations within categories
# Number of columns
category = 'emotion'
df_cat_ <- df_cat %>% filter(cat == category)
View(df_cat_)
37*4
df_cat_ <- df_cat_ %>% select(unique(df_cat_$concept))
View(df_cat_)
### category: "emotion"
#### build pivoted dataframe | cat | code | angry | happy | love | sad |
df_cat_e <- df_cat %>% filter(cat == 'emotion') %>%
pivot_wider(id_cols = c("cat", "code"), names_from = "concept", values_from = "mean_rating")
View(df_cat_e)
df_cat_ <- df_cat %>% filter(cat == category) %>%
pivot_wider(id_cols = c("cat", "code"), names_from = "concept", values_from = "mean_rating")
df_cat_ <- df_cat %>% filter(cat == category) #%>%
df_cat_conc <- unique(df_cat_$concept)
df_cat_ <- df_cat_ %>%
pivot_wider(id_cols = c("cat", "code"), names_from = "concept", values_from = "mean_rating")
# Number of columns
df_cat_ <- df_cat_ %>% select(df_cat_conc)
# Number of columns
df_cat_ <- df_cat_ %>% select(all_of(df_cat_conc))
View(df_cat_)
class(df_cat_)
df_cat_ <- as.data.frame(df_cat_)
class(df_cat_)
# Create an empty matrix to store p-values
p_values <- matrix(NA, nrow = num_cols, ncol = num_cols)
# Loop through each pair of columns
for (i in 1:(num_cols - 1)) {
for (j in (i + 1):num_cols) {
# Calculate correlation test
correlation_test <- cor.test(df_cat_e[, i], df_cat_e[, j])
# Store the p-value
p_values[i, j] <- correlation_test$p.value
p_values[j, i] <- correlation_test$p.value
}
}
# Loop through each pair of columns
for (i in 1:(num_cols - 1)) {
for (j in (i + 1):num_cols) {
# Calculate correlation test
correlation_test <- cor.test(df_cat_[, i], df_cat_[, j])
# Store the p-value
p_values[i, j] <- correlation_test$p.value
p_values[j, i] <- correlation_test$p.value
}
}
# Apply Bonferroni correction
adjusted_p_values <- p.adjust(as.vector(p_values), method = "bonferroni")
# Reshape the adjusted p-values to a matrix
adjusted_p_matrix <- matrix(adjusted_p_values, nrow = num_cols, ncol = num_cols)
print(cor(df_cat_))
View(df_cat)
within_cat_corr <- function (data, category){
# category = "emotion"
df_cat_ <- data %>% filter(cat == category)
df_cat_conc <- unique(df_cat_$concept)
df_cat_ <- df_cat_ %>%
pivot_wider(id_cols = c("cat", "code"), names_from = "concept", values_from = "mean_rating")
#### calculating pairwise correlations within a category
df_cat_ <- df_cat_ %>% select(all_of(df_cat_conc))
num_cols <- ncol(df_cat_e)
df_cat_ <- as.data.frame(df_cat_)
# Create an empty matrix to store p-values
p_values <- matrix(NA, nrow = num_cols, ncol = num_cols)
# Loop through each pair of columns
for (i in 1:(num_cols - 1)) {
for (j in (i + 1):num_cols) {
# Calculate correlation test
correlation_test <- cor.test(df_cat_[, i], df_cat_[, j])
# Store the p-value
p_values[i, j] <- correlation_test$p.value
p_values[j, i] <- correlation_test$p.value
}
}
# Apply Bonferroni correction
adjusted_p_values <- p.adjust(as.vector(p_values), method = "bonferroni")
# Reshape the adjusted p-values to a matrix
adjusted_p_matrix <- matrix(adjusted_p_values, nrow = num_cols, ncol = num_cols)
# Print the correlation matrix and adjusted p-values
print("Correlation Matrix:")
print(cor(df_cat_))
print("\nAdjusted P-values (Bonferroni Correction):")
print(adjusted_p_matrix)
}
within_cat_corr(df_cat, "emotion")
# category = "emotion"
df_cat_ <- data %>% filter(cat == category)
# category = "emotion"
df_cat_ <- df_cat %>% filter(cat == category)
df_cat_conc <- unique(df_cat_$concept)
df_cat_ <- df_cat_ %>%
pivot_wider(id_cols = c("cat", "code"), names_from = "concept", values_from = "mean_rating")
#### calculating pairwise correlations within a category
df_cat_ <- df_cat_ %>% select(all_of(df_cat_conc))
num_cols <- ncol(df_cat_e)
df_cat_ <- as.data.frame(df_cat_)
# Create an empty matrix to store p-values
p_values <- matrix(NA, nrow = num_cols, ncol = num_cols)
# Loop through each pair of columns
for (i in 1:(num_cols - 1)) {
for (j in (i + 1):num_cols) {
# Calculate correlation test
correlation_test <- cor.test(df_cat_[, i], df_cat_[, j])
# Store the p-value
p_values[i, j] <- correlation_test$p.value
p_values[j, i] <- correlation_test$p.value
}
}
# Apply Bonferroni correction
adjusted_p_values <- p.adjust(as.vector(p_values), method = "bonferroni")
# Reshape the adjusted p-values to a matrix
adjusted_p_matrix <- matrix(adjusted_p_values, nrow = num_cols, ncol = num_cols)
# Print the correlation matrix and adjusted p-values
print("Correlation Matrix:")
print(cor(df_cat_))
print("\nAdjusted P-values (Bonferroni Correction):")
print(adjusted_p_matrix)
print("\n Adjusted P-values (Bonferroni Correction):")
within_cat_corr <- function (df_cat, category){
# category = "emotion"
df_cat_ <- df_cat %>% filter(cat == category)
df_cat_conc <- unique(df_cat_$concept)
df_cat_ <- df_cat_ %>%
pivot_wider(id_cols = c("cat", "code"), names_from = "concept", values_from = "mean_rating")
#### calculating pairwise correlations within a category
df_cat_ <- df_cat_ %>% select(all_of(df_cat_conc))
num_cols <- ncol(df_cat_e)
df_cat_ <- as.data.frame(df_cat_)
# Create an empty matrix to store p-values
p_values <- matrix(NA, nrow = num_cols, ncol = num_cols)
# Loop through each pair of columns
for (i in 1:(num_cols - 1)) {
for (j in (i + 1):num_cols) {
# Calculate correlation test
correlation_test <- cor.test(df_cat_[, i], df_cat_[, j])
# Store the p-value
p_values[i, j] <- correlation_test$p.value
p_values[j, i] <- correlation_test$p.value
}
}
# Apply Bonferroni correction
adjusted_p_values <- p.adjust(as.vector(p_values), method = "bonferroni")
# Reshape the adjusted p-values to a matrix
adjusted_p_matrix <- matrix(adjusted_p_values, nrow = num_cols, ncol = num_cols)
# Print the correlation matrix and adjusted p-values
print("Correlation Matrix:")
print(cor(df_cat_))
print("Adjusted P-values (Bonferroni Correction):")
print(adjusted_p_matrix)
}
within_cat_corr(df_cat, 'emotion')
category = "emotion"
df_cat_ <- df_cat %>% filter(cat == category)
df_cat_conc <- unique(df_cat_$concept)
df_cat_ <- df_cat_ %>%
pivot_wider(id_cols = c("cat", "code"), names_from = "concept", values_from = "mean_rating")
#### calculating pairwise correlations within a category
df_cat_ <- df_cat_ %>% select(all_of(df_cat_conc))
num_cols <- ncol(df_cat_e)
df_cat_ <- as.data.frame(df_cat_)
# Create an empty matrix to store p-values
p_values <- matrix(NA, nrow = num_cols, ncol = num_cols)
# Loop through each pair of columns
for (i in 1:(num_cols - 1)) {
for (j in (i + 1):num_cols) {
# Calculate correlation test
correlation_test <- cor.test(df_cat_[, i], df_cat_[, j])
# Store the p-value
p_values[i, j] <- correlation_test$p.value
p_values[j, i] <- correlation_test$p.value
}
}
# Calculate correlation test
correlation_test <- cor.test(df_cat_[, i], df_cat_[, j])
knitr::opts_chunk$set(echo = FALSE)
source(file = './utils/exp1-utils.R')  # loads all necessary packages //NOTE: some packages
source(file = './utils/stimuli.R')
en_debug <- read_csv("data/exp1/csv/en-20231214-debug.csv") %>% rename(code = color)
en_debrief <- read_csv("data/exp1/csv/en-20231214-debrief.csv") %>% select(ID, expCountry)
en_debug <- left_join(en_debug, en_debrief, by = "ID")
en_mdg = filter(en_debug, grepl("mdg", expCountry)); en_mdg$expCountry <- 'mdg'
en_usa = filter(en_debug, !grepl("mdg", expCountry)); en_usa$expCountry <- 'usa'
en_debug = rbind(en_mdg, en_usa)
df <- en_debug %>% select(concept, code, answer, expCountry)
df$rating <- round(df$answer/100, digits = 2)
df_weights <- df %>% group_by(expCountry, concept, code) %>% summarize(
weight = round(mean(rating), digits = 2),
se = round(sd(rating)/sqrt(length(rating)), digits = 2) # standard error
)
# adding hex color values to en_debug
df_weights <- full_join(df_weights, bcp37, by = "code")
# error bars are +/- standard errors of the means: se = sd(rating/sqrt(length(rating)))
df_weights$code = fct_rev(factor(df_weights$code, levels = color_codes))
plot <- df_weights %>%
# filter(concept %in% c("carrot","justice")) %>%
ggplot(aes(x = code, y = weight, fill = hex)) +
geom_bar(stat = 'identity', color = 'black',size = 0.15, width = 0.985) +
geom_errorbar( aes(x=code, ymin=weight-se, ymax=weight+se), width=0.4, colour="black", alpha=0.6, size=0.25)+
scale_fill_identity()+
scale_y_continuous(expand = c(0, 0), limits = c(0, 1)) +
# facet_wrap(~concept+expCountry, scales = "free_x", ncol = 2, strip.position = 'right') +
facet_grid(factor(concept, levels=conceptList) ~ expCountry)+
labs(title = "mean color-concept assoc. ratings (14 participants 7/7 - library: BCP-37)", x = "", ) +
theme_bw() +
theme(legend.position = "none", strip.text = element_text(size = 12)); plot
plot <- df_weights %>%
# filter(concept %in% c("carrot","justice", "comfort", 'peace')) %>%
filter(expCountry == 'mdg') %>%
ggplot(aes(x = reorder_within(code, weight, concept), y = weight, fill = hex)) + # reoder color codes BY weight WITHIN each concept
geom_bar(stat = 'identity', color = 'black', width = 0.95, size = 0.25) +
scale_x_reordered() +
scale_fill_identity() +
scale_y_continuous(expand = c(0, 0), limits = c(0, 1)) +
# facet_grid(factor(concept, levels=conceptList) ~ expCountry)+
facet_wrap( ~factor(concept, levels=conceptList), scales = 'free_x', ncol = 4, strip.position = 'top') +
labs(title = "mean color-concept association ratings (14 participants)", x = "color code in the BCP-37 library", ) +
theme_bw() +
theme(legend.position = "none"); plot
df_cat <- df %>% mutate(
cat = case_when(
concept %in% c('angry', 'happy', 'love', 'sad') ~ 'emotion',
concept %in% c("banana", "carrot", 'mango', 'peach') ~ 'food',
concept %in% c('comfort', 'justice', 'peace', 'safety') ~ 'abstract',
concept %in% c('drought', 'hurricane', 'lightning', 'sandstorm') ~ 'weather')) %>%
group_by(cat, concept, code) %>%
summarise(mean_rating = round(mean(rating), digits = 4), .groups = 'drop')
category = "emotion"
df_cat_ <- df_cat %>% filter(cat == category)
df_cat_conc <- unique(df_cat_$concept)
df_cat_ <- df_cat_ %>%
pivot_wider(id_cols = c("cat", "code"), names_from = "concept", values_from = "mean_rating")
df_cat_ <- df_cat_ %>%
pivot_wider(id_cols = c("cat", "code"), names_from = "concept", values_from = "mean_rating")
#### calculating pairwise correlations within a category
df_cat_ <- df_cat_ %>% select(all_of(df_cat_conc))
num_cols <- ncol(df_cat_e)
num_cols <- ncol(df_cat_)
df_cat_ <- as.data.frame(df_cat_)
# Create an empty matrix to store p-values
p_values <- matrix(NA, nrow = num_cols, ncol = num_cols)
# Loop through each pair of columns
for (i in 1:(num_cols - 1)) {
for (j in (i + 1):num_cols) {
# Calculate correlation test
correlation_test <- cor.test(df_cat_[, i], df_cat_[, j])
# Store the p-value
p_values[i, j] <- correlation_test$p.value
p_values[j, i] <- correlation_test$p.value
}
}
c
within_cat_corr <- function (df_cat, category){
# category = "emotion"
df_cat_ <- df_cat %>% filter(cat == category)
df_cat_conc <- unique(df_cat_$concept)
df_cat_ <- df_cat_ %>%
pivot_wider(id_cols = c("cat", "code"), names_from = "concept", values_from = "mean_rating")
#### calculating pairwise correlations within a category
df_cat_ <- df_cat_ %>% select(all_of(df_cat_conc))
num_cols <- ncol(df_cat_)
df_cat_ <- as.data.frame(df_cat_)
# Create an empty matrix to store p-values
p_values <- matrix(NA, nrow = num_cols, ncol = num_cols)
# Loop through each pair of columns
for (i in 1:(num_cols - 1)) {
for (j in (i + 1):num_cols) {
# Calculate correlation test
correlation_test <- cor.test(df_cat_[, i], df_cat_[, j])
# Store the p-value
p_values[i, j] <- correlation_test$p.value
p_values[j, i] <- correlation_test$p.value
}
}
# Apply Bonferroni correction
adjusted_p_values <- p.adjust(as.vector(p_values), method = "bonferroni")
# Reshape the adjusted p-values to a matrix
adjusted_p_matrix <- matrix(adjusted_p_values, nrow = num_cols, ncol = num_cols)
# Print the correlation matrix and adjusted p-values
print("Correlation Matrix:")
print(cor(df_cat_))
print("Adjusted P-values (Bonferroni Correction):")
print(adjusted_p_matrix)
}
within_cat_corr(df_cat, 'emotion')
within_cat_corr(df_cat, 'food')
within_cat_corr(df_cat, 'abstract')
within_cat_corr(df_cat, 'abstract')
within_cat_corr <- function (df_cat, category){
# category = "emotion"
df_cat_ <- df_cat %>% filter(cat == category)
df_cat_conc <- unique(df_cat_$concept)
df_cat_ <- df_cat_ %>%
pivot_wider(id_cols = c("cat", "code"), names_from = "concept", values_from = "mean_rating")
#### calculating pairwise correlations within a category
df_cat_ <- df_cat_ %>% select(all_of(df_cat_conc))
num_cols <- ncol(df_cat_)
df_cat_ <- as.data.frame(df_cat_)
# Create an empty matrix to store p-values
p_values <- matrix(NA, nrow = num_cols, ncol = num_cols)
# Loop through each pair of columns
for (i in 1:(num_cols - 1)) {
for (j in (i + 1):num_cols) {
# Calculate correlation test
correlation_test <- cor.test(df_cat_[, i], df_cat_[, j])
# Store the p-value
p_values[i, j] <- correlation_test$p.value
p_values[j, i] <- correlation_test$p.value
}
}
# Apply Bonferroni correction
adjusted_p_values <- p.adjust(as.vector(p_values), method = "bonferroni")
# Reshape the adjusted p-values to a matrix
adjusted_p_matrix <- matrix(adjusted_p_values, nrow = num_cols, ncol = num_cols)
# Print the correlation matrix and adjusted p-values
print("Correlation Matrix:")
print(cor(df_cat_))
print("--------------")
print("Adjusted P-values (Bonferroni Correction):")
print(adjusted_p_matrix)
}
within_cat_corr(df_cat, 'abstract')
within_cat_corr(df_cat, 'weather')
